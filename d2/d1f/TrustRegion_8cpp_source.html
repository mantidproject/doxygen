<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mantid: Framework/CurveFitting/src/RalNlls/TrustRegion.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-59110517-2', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mantid
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_bcbb2cf9a3d3d83e5515c82071a07177.html">Framework</a></li><li class="navelem"><a class="el" href="../../dir_f6ba9a32ae555692e6e1871182ba2e85.html">CurveFitting</a></li><li class="navelem"><a class="el" href="../../dir_11debf8427233fb6b63ccc70cb684ef3.html">src</a></li><li class="navelem"><a class="el" href="../../dir_71deca4b7421e0817aa269874bd4fe26.html">RalNlls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">TrustRegion.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d2/d1f/TrustRegion_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Mantid Repository : https://github.com/mantidproject/mantid</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Copyright &amp;copy; 2018 ISIS Rutherford Appleton Laboratory UKRI,</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//   NScD Oak Ridge National Laboratory, European Spallation Source,</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">//   Institut Laue - Langevin &amp; CSNS, Institute of High Energy Physics, CAS</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// SPDX - License - Identifier: GPL - 3.0 +</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// This code was originally translated from Fortran code on</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// https://ccpforge.cse.rl.ac.uk/gf/project/ral_nlls June 2016</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// Includes</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">//----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="../../d4/da9/TrustRegion_8h.html">MantidCurveFitting/RalNlls/TrustRegion.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html">Mantid::CurveFitting::NLLS</a> {</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ae67e7e352e99bf62e001050bac02c0d2">   23</a></span><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ae67e7e352e99bf62e001050bac02c0d2">EPSILON_MCH</a> = std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a45193209b3c7924822a4cfa121b4d1f5">   31</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a45193209b3c7924822a4cfa121b4d1f5">matmultInner</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;J, <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;A) {</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a> = J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a6b26dc2d37bd3ca187c72d4cbe62fdd9">len2</a>();</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>  A.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a37de563b6413e11f1d2c9daf9ba2327d">allocate</a>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>, <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>);</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>  A.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>() = J.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aed14dcdf7c5c5c9088f18f750bb25897">inspector</a>().transpose() * J.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aed14dcdf7c5c5c9088f18f750bb25897">inspector</a>();</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>}</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#adc258ebac7d72b3e132945f567d6610e">   45</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#adc258ebac7d72b3e132945f567d6610e">getSvdJ</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;J, <span class="keywordtype">double</span> &amp;s1, <span class="keywordtype">double</span> &amp;sn) {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  Eigen::BDCSVD&lt;Eigen::MatrixXd&gt; svd(J.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aed14dcdf7c5c5c9088f18f750bb25897">inspector</a>());</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>  <span class="keyword">auto</span> S = svd.singularValues();</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  s1 = S(0);</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  sn = S(S.size() - 1);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>}</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5cf409cd90a7b2769238f5892e89c27c">   57</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5cf409cd90a7b2769238f5892e89c27c">norm2</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;v) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  <span class="keywordflow">if</span> (v.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#af48e209199d24cbe763b71f7005bf31d">size</a>() == 0)</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>  <span class="keywordflow">return</span> v.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a8518d2c262bf84cbe5152975fa167fc3">norm</a>();</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>}</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aa9b3de10f93114cad5b353ffd4fbc571">   68</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aa9b3de10f93114cad5b353ffd4fbc571">multJ</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;J, <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">x</a>, <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;Jx) {</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  <span class="comment">// dgemv(&#39;N&#39;,m,n,alpha,J,m,x,1,beta,Jx,1);</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  <span class="keywordflow">if</span> (Jx.<a class="code hl_function" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#af01ff129fcc84c40723a5dd7c0ac272d">len</a>() != J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a846d5b28c34aa3bf44c7e118e2ea3053">len1</a>()) {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    Jx.<a class="code hl_function" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#ad4ce60b15769a801181f96fc10f901d5">allocate</a>(J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a846d5b28c34aa3bf44c7e118e2ea3053">len1</a>());</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  }</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  Jx.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>() = J.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aed14dcdf7c5c5c9088f18f750bb25897">inspector</a>() * <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">x</a>.inspector();</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>}</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ac6ae5edebfd3f07e62de18924cc8270e">   82</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ac6ae5edebfd3f07e62de18924cc8270e">multJt</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;J, <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">x</a>, <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;Jtx) {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  <span class="comment">// dgemv(&#39;T&#39;,m,n,alpha,J,m,x,1,beta,Jtx,1)</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>  <span class="keywordflow">if</span> (Jtx.<a class="code hl_function" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#af01ff129fcc84c40723a5dd7c0ac272d">len</a>() != J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a6b26dc2d37bd3ca187c72d4cbe62fdd9">len2</a>()) {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    Jtx.<a class="code hl_function" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#ad4ce60b15769a801181f96fc10f901d5">allocate</a>(J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a6b26dc2d37bd3ca187c72d4cbe62fdd9">len2</a>());</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  }</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  Jtx.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>() = J.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aed14dcdf7c5c5c9088f18f750bb25897">inspector</a>().transpose() * <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">x</a>.inspector();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>}</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">   93</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">dotProduct</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">x</a>, <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#a9f73ed0b16ebc46f67c4428af703eb07">y</a>) { <span class="keywordflow">return</span> <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">x</a>.dot(<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#a9f73ed0b16ebc46f67c4428af703eb07">y</a>); }</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a406b279d9b18276d06179544aa196903">  112</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a406b279d9b18276d06179544aa196903">evaluateModel</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;f, <span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;J, <span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;hf,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                     <span class="keyword">const</span> <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#add740ce10e8799ef307d6d1b9d5c72b9">d</a>, <span class="keyword">const</span> <a class="code hl_struct" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html">nlls_options</a> &amp;options, <a class="code hl_struct" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html">evaluate_model_work</a> &amp;w) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  <span class="comment">// Jd = J*d</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>  <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aa9b3de10f93114cad5b353ffd4fbc571">multJ</a>(J, <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#add740ce10e8799ef307d6d1b9d5c72b9">d</a>, w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#a8e7bc36f0d14b82734aa57c9effb08e6">Jd</a>);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>  <span class="comment">// First, get the base</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>  <span class="comment">// 0.5 (f^T f + f^T J d + d^T&#39; J ^T J d )</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> temp = f;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  temp += w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#a8e7bc36f0d14b82734aa57c9effb08e6">Jd</a>;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#af2b284dd4075b21e61ffe30c887975f3">md_gn</a> = 0.5 * pow(<a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5cf409cd90a7b2769238f5892e89c27c">norm2</a>(temp), 2);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>  <span class="keywordtype">double</span> md = 0.0;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <span class="keywordflow">switch</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a11aa9f894f869aad609b3c86a0bff5f9">model</a>) {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  <span class="keywordflow">case</span> 1: <span class="comment">// first-order (no Hessian)</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    md = w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#af2b284dd4075b21e61ffe30c887975f3">md_gn</a>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <span class="comment">// these have a dynamic H -- recalculate</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <span class="comment">// H = J^T J + HF, HF is (an approx?) to the Hessian</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aa9b3de10f93114cad5b353ffd4fbc571">multJ</a>(hf, <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#add740ce10e8799ef307d6d1b9d5c72b9">d</a>, w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#a6e597613004e3890b2413491413224ec">Hd</a>);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    md = w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#af2b284dd4075b21e61ffe30c887975f3">md_gn</a> + 0.5 * <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">dotProduct</a>(<a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#add740ce10e8799ef307d6d1b9d5c72b9">d</a>, w.<a class="code hl_variable" href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#a6e597613004e3890b2413491413224ec">Hd</a>);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>  }</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  <span class="keywordflow">return</span> md;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>}</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a0e370ecda508902cb260bdbf0b932af2">  148</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a0e370ecda508902cb260bdbf0b932af2">calculateRho</a>(<span class="keywordtype">double</span> normf, <span class="keywordtype">double</span> normfnew, <span class="keywordtype">double</span> md, <span class="keyword">const</span> <a class="code hl_struct" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html">nlls_options</a> &amp;options) {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <a class="code hl_define" href="../../db/d39/System_8h.html#a8440e0d0d5694191d05dc392a7a7f760">UNUSED_ARG</a>(options);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <span class="keyword">auto</span> actual_reduction = (0.5 * pow(normf, 2)) - (0.5 * pow(normfnew, 2));</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <span class="keyword">auto</span> predicted_reduction = ((0.5 * pow(normf, 2)) - md);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = 0.0;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="../../dd/d52/Matrix_8cpp.html#ac6bbb05594dd33c967d0dc98e8ac8c93">fabs</a>(actual_reduction) &lt; 10 * <a class="code hl_variable" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ae67e7e352e99bf62e001050bac02c0d2">EPSILON_MCH</a>) {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = ONE;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="../../dd/d52/Matrix_8cpp.html#ac6bbb05594dd33c967d0dc98e8ac8c93">fabs</a>(predicted_reduction) &lt; 10 * <a class="code hl_variable" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ae67e7e352e99bf62e001050bac02c0d2">EPSILON_MCH</a>) {</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = ONE;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = actual_reduction / predicted_reduction;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>}</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a07c2cd0ab31ab0374b7ba350ec57f135">  167</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a07c2cd0ab31ab0374b7ba350ec57f135">rankOneUpdate</a>(<a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;hf, <a class="code hl_struct" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html">NLLS_workspace</a> &amp;w) {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  <span class="keyword">auto</span> yts = <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">dotProduct</a>(w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aa58a61490938b8d59b9ece834806827a">d</a>, w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a8d9975b7a51d1411438142a65f6895b7">y</a>);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="../../dd/d52/Matrix_8cpp.html#ac6bbb05594dd33c967d0dc98e8ac8c93">fabs</a>(yts) &lt; sqrt(10 * <a class="code hl_variable" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ae67e7e352e99bf62e001050bac02c0d2">EPSILON_MCH</a>)) {</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  }</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aa9b3de10f93114cad5b353ffd4fbc571">multJ</a>(hf, w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aa58a61490938b8d59b9ece834806827a">d</a>, w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a11eaddcaa6cf355df74bf2e44add8f81">Sks</a>); <span class="comment">// hfs = S_k * d</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>  w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a464632b966a96c78d7b7981e49e0de4c">ysharpSks</a> = w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#afc2e9f2e94525849829ad2b3923aa054">y_sharp</a>;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a464632b966a96c78d7b7981e49e0de4c">ysharpSks</a> -= w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a11eaddcaa6cf355df74bf2e44add8f81">Sks</a>;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  <span class="comment">// now, let&#39;s scale hd (Nocedal and Wright, Section 10.2)</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  <span class="keyword">auto</span> dSks = <a class="code hl_define" href="../../dd/d52/Matrix_8cpp.html#ac6bbb05594dd33c967d0dc98e8ac8c93">fabs</a>(<a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">dotProduct</a>(w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aa58a61490938b8d59b9ece834806827a">d</a>, w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a11eaddcaa6cf355df74bf2e44add8f81">Sks</a>));</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <span class="keyword">auto</span> alpha = <a class="code hl_define" href="../../dd/d52/Matrix_8cpp.html#ac6bbb05594dd33c967d0dc98e8ac8c93">fabs</a>(<a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">dotProduct</a>(w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aa58a61490938b8d59b9ece834806827a">d</a>, w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#afc2e9f2e94525849829ad2b3923aa054">y_sharp</a>)) / dSks;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  alpha = std::min(ONE, alpha);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  hf *= alpha;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  <span class="comment">// update S_k (again, as in N&amp;W, Section 10.2)</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="comment">// hf = hf + (1/yts) (y# - Sk d)^T y:</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  alpha = 1 / yts;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">hf</a>.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>() = alpha * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a464632b966a96c78d7b7981e49e0de4c">ysharpSks</a>.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>() * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a8d9975b7a51d1411438142a65f6895b7">y</a>.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>().transpose() + w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">hf</a>.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>();</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">hf</a>.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>() = alpha * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a8d9975b7a51d1411438142a65f6895b7">y</a>.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>() * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a464632b966a96c78d7b7981e49e0de4c">ysharpSks</a>.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>().transpose() + w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">hf</a>.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>();</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  alpha = -<a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">dotProduct</a>(w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a464632b966a96c78d7b7981e49e0de4c">ysharpSks</a>, w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aa58a61490938b8d59b9ece834806827a">d</a>) / (pow(yts, 2));</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">hf</a>.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>() = alpha * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a8d9975b7a51d1411438142a65f6895b7">y</a>.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>() * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a8d9975b7a51d1411438142a65f6895b7">y</a>.<a class="code hl_function" href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">mutator</a>().transpose() + w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">hf</a>.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">mutator</a>();</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>}</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a7b4e174e1bccd7a3e9a2fd2d168090f2">  205</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a7b4e174e1bccd7a3e9a2fd2d168090f2">updateTrustRegionRadius</a>(<span class="keywordtype">double</span> &amp;<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>, <span class="keyword">const</span> <a class="code hl_struct" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html">nlls_options</a> &amp;options, <a class="code hl_struct" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html">NLLS_workspace</a> &amp;w) {</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  <span class="keywordflow">switch</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a663c28076ec8ee9420dca0dd9080f6c1">tr_update_strategy</a>) {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  <span class="keywordflow">case</span> 1: <span class="comment">// default, step-function</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="keywordflow">if</span> (!std::isfinite(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>)) {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> = std::max(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2a962234fbabbde3144f9c92e17e01a4">radius_reduce</a>, options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#afc429612490eb94058e158d4ce94042a">radius_reduce_max</a>) * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>      <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = -ONE; <span class="comment">// set to be negative, so that the logic works....</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> &lt; options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a5e1fbd96a5bb397d1ef22928231ad7d6">eta_success_but_reduce</a>) {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>      <span class="comment">// unsuccessful....reduce Delta</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> = std::max(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2a962234fbabbde3144f9c92e17e01a4">radius_reduce</a>, options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#afc429612490eb94058e158d4ce94042a">radius_reduce_max</a>) * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> &lt; options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a65dfa6c173427a70a280173533dde9a5">eta_very_successful</a>) {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      <span class="comment">//  doing ok...retain status quo</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> &lt; options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2e14cc71e7872902dd6121e7285613cd">eta_too_successful</a>) {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>      <span class="comment">// more than very successful -- increase delta</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> = std::min(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a82b27cd149da926658df779a1f9b6029">maximum_radius</a>, options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a99f1ff364da3fc7ec7f1a8aa511fcc64">radius_increase</a> * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#af66233f9167ea067c60289c9b9a1ec73">normd</a>);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <span class="comment">// increase based on normd = ||d||_D</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>      <span class="comment">// if d is on the tr boundary, this is Delta</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      <span class="comment">// otherwise, point was within the tr, and there&#39;s no point</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <span class="comment">// increasing the radius</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>      <span class="comment">// too successful....accept step, but don&#39;t change w.Delta</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    }</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  <span class="keywordflow">case</span> 2: <span class="comment">//  Continuous method</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>          <span class="comment">//  Based on that proposed by Hans Bruun Nielsen, TR</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>          <span class="comment">//  IMM-REP-1999-05</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>          <span class="comment">//  http://www2.imm.dtu.dk/documents/ftp/tr99/tr05_99.pdf</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="keywordflow">if</span> (!std::isfinite(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>)) {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> = std::max(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2a962234fbabbde3144f9c92e17e01a4">radius_reduce</a>, options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#afc429612490eb94058e158d4ce94042a">radius_reduce_max</a>) * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = -ONE; <span class="comment">// set to be negative, so that the logic works....</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> &gt;= options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2e14cc71e7872902dd6121e7285613cd">eta_too_successful</a>) {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      <span class="comment">// too successful....accept step, but don&#39;t change w.Delta</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> &gt; options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a03bdda40205b7bc9fd632b6bb569979c">eta_successful</a>) {</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> = w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> * std::min(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a99f1ff364da3fc7ec7f1a8aa511fcc64">radius_increase</a>,</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                                   std::max(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2a962234fbabbde3144f9c92e17e01a4">radius_reduce</a>,</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                                            1 - ((options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a99f1ff364da3fc7ec7f1a8aa511fcc64">radius_increase</a> - 1) * (pow((1 - 2 * <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>), w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a845c8972120723f8e7531762bde64c30">tr_p</a>)))));</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a541c9186a283f8d7c1024b31fa89be37">tr_nu</a> = options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2a962234fbabbde3144f9c92e17e01a4">radius_reduce</a>;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> = w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Delta</a> * w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a541c9186a283f8d7c1024b31fa89be37">tr_nu</a>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a541c9186a283f8d7c1024b31fa89be37">tr_nu</a> = w.<a class="code hl_variable" href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a541c9186a283f8d7c1024b31fa89be37">tr_nu</a> * 0.5;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    }</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Bad strategy.&quot;</span>);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>}</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5d31397400d96d8fdb05769c047593e1">  254</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5d31397400d96d8fdb05769c047593e1">testConvergence</a>(<span class="keywordtype">double</span> normF, <span class="keywordtype">double</span> normJF, <span class="keywordtype">double</span> normF0, <span class="keywordtype">double</span> normJF0, <span class="keyword">const</span> <a class="code hl_struct" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html">nlls_options</a> &amp;options,</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>                     <a class="code hl_struct" href="../../d3/d02/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform.html">nlls_inform</a> &amp;inform) {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  <span class="keywordflow">if</span> (normF &lt;= std::max(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a724b5ec079f6d3666e3271828a7bec02">stop_g_absolute</a>, options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a0ede49ce1d3a03377cf0a7c8330c094c">stop_g_relative</a> * normF0)) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    inform.<a class="code hl_variable" href="../../d3/d02/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform.html#a3343a5705e19feb615204b59818bc97f">convergence_normf</a> = 1;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>  }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>  <span class="keywordflow">if</span> ((normJF / normF) &lt;= std::max(options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a724b5ec079f6d3666e3271828a7bec02">stop_g_absolute</a>, options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a0ede49ce1d3a03377cf0a7c8330c094c">stop_g_relative</a> * (normJF0 / normF0))) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    inform.<a class="code hl_variable" href="../../d3/d02/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform.html#ae36e6c0ec8ed8fd692b72c44271ef3a7">convergence_normg</a> = 1;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>  }</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>}</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aee5238cbf356d3dfa175c3af553f907a">  280</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aee5238cbf356d3dfa175c3af553f907a">applyScaling</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;J, <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;A, <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;v,</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                  <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;scale, <span class="keyword">const</span> <a class="code hl_struct" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html">nlls_options</a> &amp;options) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#a28924e94d69215dd4bbb247a96ce08f3">m</a> = J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a846d5b28c34aa3bf44c7e118e2ea3053">len1</a>();</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a> = J.<a class="code hl_function" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a6b26dc2d37bd3ca187c72d4cbe62fdd9">len2</a>();</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  <span class="keywordflow">if</span> (scale.<a class="code hl_function" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#af01ff129fcc84c40723a5dd7c0ac272d">len</a>() != <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>) {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    scale.<a class="code hl_function" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#ad4ce60b15769a801181f96fc10f901d5">allocate</a>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>  }</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  <span class="keywordflow">switch</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2ad4dc13a63fcc8648a7aeb3aeff199d">scale</a>) {</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  <span class="keywordflow">case</span> 1:</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>  <span class="keywordflow">case</span> 2:</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 1; ii &lt;= <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>; ++ii) { <span class="comment">// do ii = 1,n</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>      <span class="keywordtype">double</span> temp = ZERO;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>      <span class="keywordflow">if</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2ad4dc13a63fcc8648a7aeb3aeff199d">scale</a> == 1) {</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 1; jj &lt;= <a class="code hl_variable" href="../../dc/d67/namespaceMantid_1_1Geometry.html#a28924e94d69215dd4bbb247a96ce08f3">m</a>; ++jj) { <span class="comment">// for_do(jj, 1,m)</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>          <span class="comment">// get_element_of_matrix(J,m,jj,ii,Jij);</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>          temp = temp + pow(J(jj, ii), 2);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        }</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2ad4dc13a63fcc8648a7aeb3aeff199d">scale</a> == 2) {</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 1; jj &lt;= <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>; ++jj) { <span class="comment">// for_do(jj, 1,n)</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>          temp = temp + pow(A(ii, jj), 2);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        }</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      }</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>      <span class="keywordflow">if</span> (temp &lt; options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#abc9b17f9e52182a01b86260e9e95f914">scale_min</a>) {</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="keywordflow">if</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#aee9b18df0f03b32dc1fbde62a04a9667">scale_trim_min</a>) {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>          temp = options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#abc9b17f9e52182a01b86260e9e95f914">scale_min</a>;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>          temp = ONE;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp &gt; options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a4d97723092370a320c8180f95d28bc63">scale_max</a>) {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <span class="keywordflow">if</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#ac4185e6adadd2ab46373106ca67c72cd">scale_trim_max</a>) {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>          temp = options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a4d97723092370a320c8180f95d28bc63">scale_max</a>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>          temp = ONE;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>      }</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>      temp = sqrt(temp);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>      <span class="keywordflow">if</span> (options.<a class="code hl_variable" href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a703b2fac1b60882c31c8800195847dc4">scale_require_increase</a>) {</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        scale(ii) = std::max(temp, scale(ii));</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        scale(ii) = temp;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>      }</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    }</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>  <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Scaling error.&quot;</span>);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>  }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>  <span class="comment">// Now we have the w.diagonal scaling matrix, actually scale the</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>  <span class="comment">// Hessian approximation and J^Tf</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 1; ii &lt;= <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>; ++ii) { <span class="comment">// for_do(ii, 1,n)</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="keywordtype">double</span> temp = scale(ii);</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    v(ii) = v(ii) / temp;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 1; jj &lt;= <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>; ++jj) { <span class="comment">// for_do(jj,1,n)</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      A(ii, jj) = A(ii, jj) / temp;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>      A(jj, ii) = A(jj, ii) / temp;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>}</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno"><a class="line" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a8289ff71bef7ab7620924748fe63187f">  348</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a8289ff71bef7ab7620924748fe63187f">allEigSymm</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;A, <a class="code hl_class" href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">DoubleFortranVector</a> &amp;ew, <a class="code hl_class" href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">DoubleFortranMatrix</a> &amp;ev) {</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>  <span class="keyword">auto</span> M = A;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>  M.<a class="code hl_function" href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#a44c31c9bf6b0f9bd2dbef231fd4abdc1">eigenSystem</a>(ew, ev);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>}</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment">// This isn&#39;t used because we don&#39;t calculate second derivatives in Mantid</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment">// If we start using them the method should be un-commented and used here</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="comment">//</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="comment">// void apply_second_order_info(int n, int m, const DoubleFortranVector &amp;X,</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="comment">//                             NLLS_workspace &amp;w, eval_hf_type evalHF,</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="comment">//                             params_base_type params,</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="comment">//                             const nlls_options &amp;options, nlls_inform &amp;inform,</span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span><span class="comment">//                             const DoubleFortranVector &amp;weights) {</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="comment">//</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="comment">//  if (options.exact_second_derivatives) {</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="comment">//    DoubleFortranVector temp = w.f;</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment">//    temp *= weights;</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment">//    evalHF(inform.external_return, n, m, X, temp, w.hf, params);</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment">//    inform.h_eval = inform.h_eval + 1;</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment">//  } else {</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">//    // use the rank-one approximation...</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="comment">//    rankOneUpdate(w.hf, w, n);</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment">//  }</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="comment">//}</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>} <span class="comment">// namespace Mantid::CurveFitting::NLLS</span></div>
<div class="ttc" id="aAugmentedLagrangianOptimizer_8cpp_html_a3d05cf6aa68b03e254d70afbe869e305"><div class="ttname"><a href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3d05cf6aa68b03e254d70afbe869e305">n</a></div><div class="ttdeci">size_t n</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp_source.html#l00042">AugmentedLagrangianOptimizer.cpp:42</a></div></div>
<div class="ttc" id="aAugmentedLagrangianOptimizer_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp_source.html#l00048">AugmentedLagrangianOptimizer.cpp:48</a></div></div>
<div class="ttc" id="aMatrix_8cpp_html_ac6bbb05594dd33c967d0dc98e8ac8c93"><div class="ttname"><a href="../../dd/d52/Matrix_8cpp.html#ac6bbb05594dd33c967d0dc98e8ac8c93">fabs</a></div><div class="ttdeci">#define fabs(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d52/Matrix_8cpp_source.html#l00022">Matrix.cpp:22</a></div></div>
<div class="ttc" id="aSystem_8h_html_a8440e0d0d5694191d05dc392a7a7f760"><div class="ttname"><a href="../../db/d39/System_8h.html#a8440e0d0d5694191d05dc392a7a7f760">UNUSED_ARG</a></div><div class="ttdeci">#define UNUSED_ARG(x)</div><div class="ttdoc">Function arguments are sometimes unused in certain implmentations but are required for documentation ...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d39/System_8h_source.html#l00064">System.h:64</a></div></div>
<div class="ttc" id="aTrustRegion_8h_html"><div class="ttname"><a href="../../d4/da9/TrustRegion_8h.html">TrustRegion.h</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1EigenMatrix_html_a44c31c9bf6b0f9bd2dbef231fd4abdc1"><div class="ttname"><a href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#a44c31c9bf6b0f9bd2dbef231fd4abdc1">Mantid::CurveFitting::EigenMatrix::eigenSystem</a></div><div class="ttdeci">void eigenSystem(EigenVector &amp;eigenValues, EigenMatrix &amp;eigenVectors)</div><div class="ttdoc">Calculate the eigensystem of a symmetric matrix.</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d4c/EigenMatrix_8cpp_source.html#l00299">EigenMatrix.cpp:299</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1EigenMatrix_html_aa88c3685de98ffa47ee89295373032e7"><div class="ttname"><a href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aa88c3685de98ffa47ee89295373032e7">Mantid::CurveFitting::EigenMatrix::mutator</a></div><div class="ttdeci">map_type &amp; mutator()</div><div class="ttdoc">Get the map to Eigen matrix.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da8/EigenMatrix_8h_source.html#l00056">EigenMatrix.h:56</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1EigenMatrix_html_aed14dcdf7c5c5c9088f18f750bb25897"><div class="ttname"><a href="../../d9/dfb/classMantid_1_1CurveFitting_1_1EigenMatrix.html#aed14dcdf7c5c5c9088f18f750bb25897">Mantid::CurveFitting::EigenMatrix::inspector</a></div><div class="ttdeci">const map_type inspector() const</div><div class="ttdoc">Get a const copy of the Eigen matrix.</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da8/EigenMatrix_8h_source.html#l00058">EigenMatrix.h:58</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1EigenVector_html_a5fbeb597404dddf3da41c3d40268c30b"><div class="ttname"><a href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a5fbeb597404dddf3da41c3d40268c30b">Mantid::CurveFitting::EigenVector::mutator</a></div><div class="ttdeci">vec_map_type &amp; mutator()</div><div class="ttdoc">Get the map of the eigen vector.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d89/EigenVector_8h_source.html#l00051">EigenVector.h:51</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1EigenVector_html_a8518d2c262bf84cbe5152975fa167fc3"><div class="ttname"><a href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#a8518d2c262bf84cbe5152975fa167fc3">Mantid::CurveFitting::EigenVector::norm</a></div><div class="ttdeci">double norm() const</div><div class="ttdoc">Get vector norm (length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/EigenVector_8cpp_source.html#l00189">EigenVector.cpp:189</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1EigenVector_html_af48e209199d24cbe763b71f7005bf31d"><div class="ttname"><a href="../../d3/d03/classMantid_1_1CurveFitting_1_1EigenVector.html#af48e209199d24cbe763b71f7005bf31d">Mantid::CurveFitting::EigenVector::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">Size of the vector.</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/EigenVector_8cpp_source.html#l00108">EigenVector.cpp:108</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranMatrix_html"><div class="ttname"><a href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html">Mantid::CurveFitting::FortranMatrix&lt; EigenMatrix &gt;</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranMatrix_html_a37de563b6413e11f1d2c9daf9ba2327d"><div class="ttname"><a href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a37de563b6413e11f1d2c9daf9ba2327d">Mantid::CurveFitting::FortranMatrix::allocate</a></div><div class="ttdeci">void allocate(const int iFrom, const int iTo, const int jFrom, const int jTo)</div><div class="ttdoc">Resize the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/EigenFortranMatrix_8h_source.html#l00103">EigenFortranMatrix.h:103</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranMatrix_html_a6b26dc2d37bd3ca187c72d4cbe62fdd9"><div class="ttname"><a href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a6b26dc2d37bd3ca187c72d4cbe62fdd9">Mantid::CurveFitting::FortranMatrix::len2</a></div><div class="ttdeci">int len2() const</div><div class="ttdoc">Get the size along the second dimension as an int.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/EigenFortranMatrix_8h_source.html#l00140">EigenFortranMatrix.h:140</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranMatrix_html_a846d5b28c34aa3bf44c7e118e2ea3053"><div class="ttname"><a href="../../d8/de4/classMantid_1_1CurveFitting_1_1FortranMatrix.html#a846d5b28c34aa3bf44c7e118e2ea3053">Mantid::CurveFitting::FortranMatrix::len1</a></div><div class="ttdeci">int len1() const</div><div class="ttdoc">Get the size along the first dimension as an int.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/EigenFortranMatrix_8h_source.html#l00137">EigenFortranMatrix.h:137</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranVector_html"><div class="ttname"><a href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html">Mantid::CurveFitting::FortranVector&lt; EigenVector &gt;</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranVector_html_ad4ce60b15769a801181f96fc10f901d5"><div class="ttname"><a href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#ad4ce60b15769a801181f96fc10f901d5">Mantid::CurveFitting::FortranVector::allocate</a></div><div class="ttdeci">void allocate(int firstIndex, int lastIndex)</div><div class="ttdoc">Resize the vector.</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d32/EigenFortranVector_8h_source.html#l00085">EigenFortranVector.h:85</a></div></div>
<div class="ttc" id="aclassMantid_1_1CurveFitting_1_1FortranVector_html_af01ff129fcc84c40723a5dd7c0ac272d"><div class="ttname"><a href="../../d1/d10/classMantid_1_1CurveFitting_1_1FortranVector.html#af01ff129fcc84c40723a5dd7c0ac272d">Mantid::CurveFitting::FortranVector::len</a></div><div class="ttdeci">int len() const</div><div class="ttdoc">Get the length of the vector as an int.</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d32/EigenFortranVector_8h_source.html#l00130">EigenFortranVector.h:130</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html">Mantid::CurveFitting::NLLS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/TrustRegion_8h_source.html#l00015">TrustRegion.h:15</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a07c2cd0ab31ab0374b7ba350ec57f135"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a07c2cd0ab31ab0374b7ba350ec57f135">Mantid::CurveFitting::NLLS::rankOneUpdate</a></div><div class="ttdeci">void rankOneUpdate(DoubleFortranMatrix &amp;hf, NLLS_workspace &amp;w)</div><div class="ttdoc">Update the Hessian matrix without actually evaluating it (quasi-Newton?)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00167">TrustRegion.cpp:167</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a0e370ecda508902cb260bdbf0b932af2"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a0e370ecda508902cb260bdbf0b932af2">Mantid::CurveFitting::NLLS::calculateRho</a></div><div class="ttdeci">double calculateRho(double normf, double normfnew, double md, const nlls_options &amp;options)</div><div class="ttdoc">Calculate the quantity 0.5||f||^2 - 0.5||fnew||^2 actual_reduction rho = ----------------------- = -...</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00148">TrustRegion.cpp:148</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a406b279d9b18276d06179544aa196903"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a406b279d9b18276d06179544aa196903">Mantid::CurveFitting::NLLS::evaluateModel</a></div><div class="ttdeci">double evaluateModel(const DoubleFortranVector &amp;f, const DoubleFortranMatrix &amp;J, const DoubleFortranMatrix &amp;hf, const DoubleFortranVector &amp;d, const nlls_options &amp;options, evaluate_model_work &amp;w)</div><div class="ttdoc">Input: f = f(x_k), J = J(x_k), hf = \sum_{i=1}^m f_i(x_k) \nabla^2 f_i(x_k) (or an approx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00112">TrustRegion.cpp:112</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a45193209b3c7924822a4cfa121b4d1f5"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a45193209b3c7924822a4cfa121b4d1f5">Mantid::CurveFitting::NLLS::matmultInner</a></div><div class="ttdeci">void MANTID_CURVEFITTING_DLL matmultInner(const DoubleFortranMatrix &amp;J, DoubleFortranMatrix &amp;A)</div><div class="ttdoc">Takes an m x n matrix J and forms the n x n matrix A given by A = J' * J.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00031">TrustRegion.cpp:31</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a5cf409cd90a7b2769238f5892e89c27c"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5cf409cd90a7b2769238f5892e89c27c">Mantid::CurveFitting::NLLS::norm2</a></div><div class="ttdeci">double MANTID_CURVEFITTING_DLL norm2(const DoubleFortranVector &amp;v)</div><div class="ttdoc">Compute the 2-norm of a vector which is a square root of the sum of squares of its elements.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00057">TrustRegion.cpp:57</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a5d31397400d96d8fdb05769c047593e1"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a5d31397400d96d8fdb05769c047593e1">Mantid::CurveFitting::NLLS::testConvergence</a></div><div class="ttdeci">void testConvergence(double normF, double normJF, double normF0, double normJF0, const nlls_options &amp;options, nlls_inform &amp;inform)</div><div class="ttdoc">Test the convergence.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00254">TrustRegion.cpp:254</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a7b4e174e1bccd7a3e9a2fd2d168090f2"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a7b4e174e1bccd7a3e9a2fd2d168090f2">Mantid::CurveFitting::NLLS::updateTrustRegionRadius</a></div><div class="ttdeci">void updateTrustRegionRadius(double &amp;rho, const nlls_options &amp;options, NLLS_workspace &amp;w)</div><div class="ttdoc">Update the trust region radius which is hidden in NLLS_workspace w (w.Delta).</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00205">TrustRegion.cpp:205</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_a8289ff71bef7ab7620924748fe63187f"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#a8289ff71bef7ab7620924748fe63187f">Mantid::CurveFitting::NLLS::allEigSymm</a></div><div class="ttdeci">void allEigSymm(const DoubleFortranMatrix &amp;A, DoubleFortranVector &amp;ew, DoubleFortranMatrix &amp;ev)</div><div class="ttdoc">Calculate all the eigenvalues of a symmetric matrix.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00348">TrustRegion.cpp:348</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_aa9b3de10f93114cad5b353ffd4fbc571"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aa9b3de10f93114cad5b353ffd4fbc571">Mantid::CurveFitting::NLLS::multJ</a></div><div class="ttdeci">void MANTID_CURVEFITTING_DLL multJ(const DoubleFortranMatrix &amp;J, const DoubleFortranVector &amp;x, DoubleFortranVector &amp;Jx)</div><div class="ttdoc">Multiply a matrix by a vector.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00068">TrustRegion.cpp:68</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_ac6ae5edebfd3f07e62de18924cc8270e"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ac6ae5edebfd3f07e62de18924cc8270e">Mantid::CurveFitting::NLLS::multJt</a></div><div class="ttdeci">void MANTID_CURVEFITTING_DLL multJt(const DoubleFortranMatrix &amp;J, const DoubleFortranVector &amp;x, DoubleFortranVector &amp;Jtx)</div><div class="ttdoc">Multiply a transposed matrix by a vector.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00082">TrustRegion.cpp:82</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_ad27d2c0b63bb675f990f85e20f4bd0a9"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ad27d2c0b63bb675f990f85e20f4bd0a9">Mantid::CurveFitting::NLLS::dotProduct</a></div><div class="ttdeci">double dotProduct(const DoubleFortranVector &amp;x, const DoubleFortranVector &amp;y)</div><div class="ttdoc">Dot product of two vectors.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00093">TrustRegion.cpp:93</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_adc258ebac7d72b3e132945f567d6610e"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#adc258ebac7d72b3e132945f567d6610e">Mantid::CurveFitting::NLLS::getSvdJ</a></div><div class="ttdeci">void MANTID_CURVEFITTING_DLL getSvdJ(const DoubleFortranMatrix &amp;J, double &amp;s1, double &amp;sn)</div><div class="ttdoc">Given an (m x n) matrix J held by columns as a vector, this routine returns the largest and smallest ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00045">TrustRegion.cpp:45</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_ae67e7e352e99bf62e001050bac02c0d2"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#ae67e7e352e99bf62e001050bac02c0d2">Mantid::CurveFitting::NLLS::EPSILON_MCH</a></div><div class="ttdeci">const double EPSILON_MCH</div><div class="ttdoc">Too small values don't work well with numerical derivatives.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00023">TrustRegion.cpp:23</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1CurveFitting_1_1NLLS_html_aee5238cbf356d3dfa175c3af553f907a"><div class="ttname"><a href="../../d2/d20/namespaceMantid_1_1CurveFitting_1_1NLLS.html#aee5238cbf356d3dfa175c3af553f907a">Mantid::CurveFitting::NLLS::applyScaling</a></div><div class="ttdeci">void applyScaling(const DoubleFortranMatrix &amp;J, DoubleFortranMatrix &amp;A, DoubleFortranVector &amp;v, DoubleFortranVector &amp;scale, const nlls_options &amp;options)</div><div class="ttdoc">Apply_scaling input Jacobian matrix, J ouput scaled Hessisan, H, and J^Tf, v.</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1f/TrustRegion_8cpp_source.html#l00280">TrustRegion.cpp:280</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1Geometry_html_a28924e94d69215dd4bbb247a96ce08f3"><div class="ttname"><a href="../../dc/d67/namespaceMantid_1_1Geometry.html#a28924e94d69215dd4bbb247a96ce08f3">Mantid::Geometry::m</a></div><div class="ttdeci">z F d m</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Geometry_2src_2Crystal_2SpaceGroupFactory_8cpp_source.html#l00803">SpaceGroupFactory.cpp:803</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1Geometry_html_a9f73ed0b16ebc46f67c4428af703eb07"><div class="ttname"><a href="../../dc/d67/namespaceMantid_1_1Geometry.html#a9f73ed0b16ebc46f67c4428af703eb07">Mantid::Geometry::y</a></div><div class="ttdeci">I a m y</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Geometry_2src_2Crystal_2SpaceGroupFactory_8cpp_source.html#l00675">SpaceGroupFactory.cpp:675</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1Geometry_html_add740ce10e8799ef307d6d1b9d5c72b9"><div class="ttname"><a href="../../dc/d67/namespaceMantid_1_1Geometry.html#add740ce10e8799ef307d6d1b9d5c72b9">Mantid::Geometry::d</a></div><div class="ttdeci">I a m d</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Geometry_2src_2Crystal_2SpaceGroupFactory_8cpp_source.html#l00674">SpaceGroupFactory.cpp:674</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1Geometry_html_af9966bf83559a0e8759072837e5ab80f"><div class="ttname"><a href="../../dc/d67/namespaceMantid_1_1Geometry.html#af9966bf83559a0e8759072837e5ab80f">Mantid::Geometry::x</a></div><div class="ttdeci">I a m x</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d82/Geometry_2src_2Crystal_2SpaceGroupFactory_8cpp_source.html#l00675">SpaceGroupFactory.cpp:675</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html">Mantid::CurveFitting::NLLS::NLLS_workspace</a></div><div class="ttdoc">all workspaces called from the top level</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00251">Workspaces.h:251</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_a11eaddcaa6cf355df74bf2e44add8f81"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a11eaddcaa6cf355df74bf2e44add8f81">Mantid::CurveFitting::NLLS::NLLS_workspace::Sks</a></div><div class="ttdeci">DoubleFortranVector Sks</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00269">Workspaces.h:269</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_a464632b966a96c78d7b7981e49e0de4c"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a464632b966a96c78d7b7981e49e0de4c">Mantid::CurveFitting::NLLS::NLLS_workspace::ysharpSks</a></div><div class="ttdeci">DoubleFortranVector ysharpSks</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00269">Workspaces.h:269</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_a541c9186a283f8d7c1024b31fa89be37"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a541c9186a283f8d7c1024b31fa89be37">Mantid::CurveFitting::NLLS::NLLS_workspace::tr_nu</a></div><div class="ttdeci">double tr_nu</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00261">Workspaces.h:261</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_a6971062d5eea50b5323833db4ae19da9"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a6971062d5eea50b5323833db4ae19da9">Mantid::CurveFitting::NLLS::NLLS_workspace::hf</a></div><div class="ttdeci">DoubleFortranMatrix hf</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00266">Workspaces.h:266</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_a845c8972120723f8e7531762bde64c30"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a845c8972120723f8e7531762bde64c30">Mantid::CurveFitting::NLLS::NLLS_workspace::tr_p</a></div><div class="ttdeci">int tr_p</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00262">Workspaces.h:262</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_a8d9975b7a51d1411438142a65f6895b7"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#a8d9975b7a51d1411438142a65f6895b7">Mantid::CurveFitting::NLLS::NLLS_workspace::y</a></div><div class="ttdeci">DoubleFortranVector y</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00268">Workspaces.h:268</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_aa58a61490938b8d59b9ece834806827a"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aa58a61490938b8d59b9ece834806827a">Mantid::CurveFitting::NLLS::NLLS_workspace::d</a></div><div class="ttdeci">DoubleFortranVector d</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00267">Workspaces.h:267</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_aaf3b92e7525e125d14d27aac974229c2"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#aaf3b92e7525e125d14d27aac974229c2">Mantid::CurveFitting::NLLS::NLLS_workspace::Delta</a></div><div class="ttdeci">double Delta</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00256">Workspaces.h:256</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_af66233f9167ea067c60289c9b9a1ec73"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#af66233f9167ea067c60289c9b9a1ec73">Mantid::CurveFitting::NLLS::NLLS_workspace::normd</a></div><div class="ttdeci">double normd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00257">Workspaces.h:257</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace_html_afc2e9f2e94525849829ad2b3923aa054"><div class="ttname"><a href="../../d9/dcf/structMantid_1_1CurveFitting_1_1NLLS_1_1NLLS__workspace.html#afc2e9f2e94525849829ad2b3923aa054">Mantid::CurveFitting::NLLS::NLLS_workspace::y_sharp</a></div><div class="ttdeci">DoubleFortranVector y_sharp</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00268">Workspaces.h:268</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work_html"><div class="ttname"><a href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html">Mantid::CurveFitting::NLLS::evaluate_model_work</a></div><div class="ttdoc">workspace for subroutine evaluateModel</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00222">Workspaces.h:222</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work_html_a6e597613004e3890b2413491413224ec"><div class="ttname"><a href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#a6e597613004e3890b2413491413224ec">Mantid::CurveFitting::NLLS::evaluate_model_work::Hd</a></div><div class="ttdeci">DoubleFortranVector Hd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00223">Workspaces.h:223</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work_html_a8e7bc36f0d14b82734aa57c9effb08e6"><div class="ttname"><a href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#a8e7bc36f0d14b82734aa57c9effb08e6">Mantid::CurveFitting::NLLS::evaluate_model_work::Jd</a></div><div class="ttdeci">DoubleFortranVector Jd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00223">Workspaces.h:223</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work_html_af2b284dd4075b21e61ffe30c887975f3"><div class="ttname"><a href="../../d8/d1d/structMantid_1_1CurveFitting_1_1NLLS_1_1evaluate__model__work.html#af2b284dd4075b21e61ffe30c887975f3">Mantid::CurveFitting::NLLS::evaluate_model_work::md_gn</a></div><div class="ttdeci">double md_gn</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00224">Workspaces.h:224</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform_html"><div class="ttname"><a href="../../d3/d02/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform.html">Mantid::CurveFitting::NLLS::nlls_inform</a></div><div class="ttdoc">inform derived type with component defaults</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00157">Workspaces.h:157</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform_html_a3343a5705e19feb615204b59818bc97f"><div class="ttname"><a href="../../d3/d02/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform.html#a3343a5705e19feb615204b59818bc97f">Mantid::CurveFitting::NLLS::nlls_inform::convergence_normf</a></div><div class="ttdeci">int convergence_normf</div><div class="ttdoc">test on the size of f satisfied?</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00172">Workspaces.h:172</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform_html_ae36e6c0ec8ed8fd692b72c44271ef3a7"><div class="ttname"><a href="../../d3/d02/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__inform.html#ae36e6c0ec8ed8fd692b72c44271ef3a7">Mantid::CurveFitting::NLLS::nlls_inform::convergence_normg</a></div><div class="ttdeci">int convergence_normg</div><div class="ttdoc">test on the size of the gradient satisfied?</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00175">Workspaces.h:175</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html">Mantid::CurveFitting::NLLS::nlls_options</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00033">Workspaces.h:33</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a03bdda40205b7bc9fd632b6bb569979c"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a03bdda40205b7bc9fd632b6bb569979c">Mantid::CurveFitting::NLLS::nlls_options::eta_successful</a></div><div class="ttdeci">double eta_successful</div><div class="ttdoc">a potential iterate will only be accepted if the actual decrease f - f(x_new) is larger than ....</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00088">Workspaces.h:88</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a0ede49ce1d3a03377cf0a7c8330c094c"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a0ede49ce1d3a03377cf0a7c8330c094c">Mantid::CurveFitting::NLLS::nlls_options::stop_g_relative</a></div><div class="ttdeci">double stop_g_relative</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00064">Workspaces.h:64</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a11aa9f894f869aad609b3c86a0bff5f9"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a11aa9f894f869aad609b3c86a0bff5f9">Mantid::CurveFitting::NLLS::nlls_options::model</a></div><div class="ttdeci">int model</div><div class="ttdoc">specify the model used.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00046">Workspaces.h:46</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a2a962234fbabbde3144f9c92e17e01a4"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2a962234fbabbde3144f9c92e17e01a4">Mantid::CurveFitting::NLLS::nlls_options::radius_reduce</a></div><div class="ttdeci">double radius_reduce</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00100">Workspaces.h:100</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a2ad4dc13a63fcc8648a7aeb3aeff199d"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2ad4dc13a63fcc8648a7aeb3aeff199d">Mantid::CurveFitting::NLLS::nlls_options::scale</a></div><div class="ttdeci">int scale</div><div class="ttdoc">scale the variables? 0 - no scaling 1 - use the scaling in GSL (W s.t.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00125">Workspaces.h:125</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a2e14cc71e7872902dd6121e7285613cd"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a2e14cc71e7872902dd6121e7285613cd">Mantid::CurveFitting::NLLS::nlls_options::eta_too_successful</a></div><div class="ttdeci">double eta_too_successful</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00091">Workspaces.h:91</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a4d97723092370a320c8180f95d28bc63"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a4d97723092370a320c8180f95d28bc63">Mantid::CurveFitting::NLLS::nlls_options::scale_max</a></div><div class="ttdeci">double scale_max</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00126">Workspaces.h:126</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a5e1fbd96a5bb397d1ef22928231ad7d6"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a5e1fbd96a5bb397d1ef22928231ad7d6">Mantid::CurveFitting::NLLS::nlls_options::eta_success_but_reduce</a></div><div class="ttdeci">double eta_success_but_reduce</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00089">Workspaces.h:89</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a65dfa6c173427a70a280173533dde9a5"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a65dfa6c173427a70a280173533dde9a5">Mantid::CurveFitting::NLLS::nlls_options::eta_very_successful</a></div><div class="ttdeci">double eta_very_successful</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00090">Workspaces.h:90</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a663c28076ec8ee9420dca0dd9080f6c1"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a663c28076ec8ee9420dca0dd9080f6c1">Mantid::CurveFitting::NLLS::nlls_options::tr_update_strategy</a></div><div class="ttdeci">int tr_update_strategy</div><div class="ttdoc">Trust region update strategy 1 - usual step function 2 - continuous method of Hans Bruun Nielsen (IMM...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00106">Workspaces.h:106</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a703b2fac1b60882c31c8800195847dc4"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a703b2fac1b60882c31c8800195847dc4">Mantid::CurveFitting::NLLS::nlls_options::scale_require_increase</a></div><div class="ttdeci">bool scale_require_increase</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00130">Workspaces.h:130</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a724b5ec079f6d3666e3271828a7bec02"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a724b5ec079f6d3666e3271828a7bec02">Mantid::CurveFitting::NLLS::nlls_options::stop_g_absolute</a></div><div class="ttdeci">double stop_g_absolute</div><div class="ttdoc">overall convergence tolerances.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00063">Workspaces.h:63</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a82b27cd149da926658df779a1f9b6029"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a82b27cd149da926658df779a1f9b6029">Mantid::CurveFitting::NLLS::nlls_options::maximum_radius</a></div><div class="ttdeci">double maximum_radius</div><div class="ttdoc">maximum permitted trust-region radius</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00080">Workspaces.h:80</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_a99f1ff364da3fc7ec7f1a8aa511fcc64"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#a99f1ff364da3fc7ec7f1a8aa511fcc64">Mantid::CurveFitting::NLLS::nlls_options::radius_increase</a></div><div class="ttdeci">double radius_increase</div><div class="ttdoc">on very successful iterations, the trust-region radius will be increased by the factor ....</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00099">Workspaces.h:99</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_abc9b17f9e52182a01b86260e9e95f914"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#abc9b17f9e52182a01b86260e9e95f914">Mantid::CurveFitting::NLLS::nlls_options::scale_min</a></div><div class="ttdeci">double scale_min</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00127">Workspaces.h:127</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_ac4185e6adadd2ab46373106ca67c72cd"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#ac4185e6adadd2ab46373106ca67c72cd">Mantid::CurveFitting::NLLS::nlls_options::scale_trim_max</a></div><div class="ttdeci">bool scale_trim_max</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00129">Workspaces.h:129</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_aee9b18df0f03b32dc1fbde62a04a9667"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#aee9b18df0f03b32dc1fbde62a04a9667">Mantid::CurveFitting::NLLS::nlls_options::scale_trim_min</a></div><div class="ttdeci">bool scale_trim_min</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00128">Workspaces.h:128</a></div></div>
<div class="ttc" id="astructMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options_html_afc429612490eb94058e158d4ce94042a"><div class="ttname"><a href="../../d8/d41/structMantid_1_1CurveFitting_1_1NLLS_1_1nlls__options.html#afc429612490eb94058e158d4ce94042a">Mantid::CurveFitting::NLLS::nlls_options::radius_reduce_max</a></div><div class="ttdeci">double radius_reduce_max</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d05/Workspaces_8h_source.html#l00101">Workspaces.h:101</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 3 2023 11:57:38 for Mantid by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
