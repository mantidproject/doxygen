<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mantid: Mantid::DataHandling::ORNLDataArchive Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-59110517-2', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mantid
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d8e/namespaceMantid.html">Mantid</a></li><li class="navelem"><a class="el" href="../../d8/d23/namespaceMantid_1_1DataHandling.html">DataHandling</a></li><li class="navelem"><a class="el" href="../../d1/d75/classMantid_1_1DataHandling_1_1ORNLDataArchive.html">ORNLDataArchive</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d5/d20/classMantid_1_1DataHandling_1_1ORNLDataArchive-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Mantid::DataHandling::ORNLDataArchive Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Please see the .cpp file for more information.  
 <a href="../../d1/d75/classMantid_1_1DataHandling_1_1ORNLDataArchive.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html">ORNLDataArchive.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Mantid::DataHandling::ORNLDataArchive:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d1/d75/classMantid_1_1DataHandling_1_1ORNLDataArchive.png" usemap="#Mantid::DataHandling::ORNLDataArchive_map" alt=""/>
  <map id="Mantid::DataHandling::ORNLDataArchive_map" name="Mantid::DataHandling::ORNLDataArchive_map">
<area href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html" title="This class is an archive searching interface." alt="Mantid::API::IArchiveSearch" shape="rect" coords="0,0,243,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab0b6864b42f2479dcbe248b1910a7338"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/classMantid_1_1DataHandling_1_1ORNLDataArchive.html#ab0b6864b42f2479dcbe248b1910a7338">getArchivePath</a> (const std::set&lt; std::string &gt; &amp;basenames, const std::vector&lt; std::string &gt; &amp;suffixes) const override</td></tr>
<tr class="separator:ab0b6864b42f2479dcbe248b1910a7338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac747a7ad9b631d26568d5a4466067f72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/classMantid_1_1DataHandling_1_1ORNLDataArchive.html#ac747a7ad9b631d26568d5a4466067f72">setONCat</a> (ONCat_uptr oncat)</td></tr>
<tr class="separator:ac747a7ad9b631d26568d5a4466067f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMantid_1_1API_1_1IArchiveSearch')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html">Mantid::API::IArchiveSearch</a></td></tr>
<tr class="memitem:ab79feafa78b11135830e434bff3bd0b6 inherit pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html#ab79feafa78b11135830e434bff3bd0b6">getArchivePath</a> (const std::set&lt; std::string &gt; &amp;filenames, const std::vector&lt; std::string &gt; &amp;exts) const =0</td></tr>
<tr class="memdesc:ab79feafa78b11135830e434bff3bd0b6 inherit pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the full path to a data file in an archive.  <a href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html#ab79feafa78b11135830e434bff3bd0b6">More...</a><br /></td></tr>
<tr class="separator:ab79feafa78b11135830e434bff3bd0b6 inherit pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb4e159c362778da2b44e2c3978ac8a inherit pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html#abcb4e159c362778da2b44e2c3978ac8a">~IArchiveSearch</a> ()=default</td></tr>
<tr class="memdesc:abcb4e159c362778da2b44e2c3978ac8a inherit pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor.  <a href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html#abcb4e159c362778da2b44e2c3978ac8a">More...</a><br /></td></tr>
<tr class="separator:abcb4e159c362778da2b44e2c3978ac8a inherit pub_methods_classMantid_1_1API_1_1IArchiveSearch"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a3c0369eea9c26d424bb259eedbff8624"><td class="memItemLeft" align="right" valign="top">ONCat_uptr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d75/classMantid_1_1DataHandling_1_1ORNLDataArchive.html#a3c0369eea9c26d424bb259eedbff8624">m_oncat</a> = nullptr</td></tr>
<tr class="separator:a3c0369eea9c26d424bb259eedbff8624"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Please see the .cpp file for more information. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html#l00026">26</a> of file <a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html">ORNLDataArchive.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab0b6864b42f2479dcbe248b1910a7338" name="ab0b6864b42f2479dcbe248b1910a7338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b6864b42f2479dcbe248b1910a7338">&#9670;&#160;</a></span>getArchivePath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Mantid::DataHandling::ORNLDataArchive::getArchivePath </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>basenames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>suffixes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<hr  />
<p> PLEASE READ THIS </p><hr  />
<p >This archive searcher retrieves SNS / HFIR run locations from ONCat.</p>
<p >Something to bear in mind here, however, is that the signature of IArchiveSearch's getArchivePath is quite counter-intuitive, and so probably shouldn't be used as an aid to understanding. This is because:</p>
<p >1) It claims to deal in "filenames" and "exts", but in reality "basenames" and "suffixes" would be more accurate terms. (In general, "[INST]_[RUN]" is the format of expected "filenames", and "_event.nxs" is one example of a possible "extension".) I've just gone ahead and started using the more accurate terms here.</p>
<p >2) It accepts a <em>collection</em> of basenames, but can only ever output a <em>single</em> file path. An inspection of the surrounding code in FileFinder will show that this has been done as a workaround to accomodate caseless- searching of directories on platforms where case make a difference.</p>
<p >(So, when it says "getArchivePath", it really does mean <em>path</em> &ndash; if you want to search for a range of runs then you will either have to extend the interface, or make multiple calls to the existing one.)</p>
<p >3) The implementation for SNS / ORNL has never (and will never) require all the basenames passed to it &ndash; it just discards all but the first and then uses that.</p>
<p >4) In the cases where multiple versions of a raw run file exist in the archive, we will have only ever ingested <em>one</em> of them into ONCat. (Where, for example, "*_event.nxs" takes precedence over "*_histo.nxs".) For this reason, a collection of suffixes is not exactly necessary, either.</p>
<p >What we're <em>actually</em> doing here then is a best-effort with the information we're given', and returning only the location of the files we know about. We'll parse the run number and the instrument, and then make sure the location ends in one of the expected suffixes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">basenames</td><td>: A set of basenames to check against. Only the first will be used. </td></tr>
    <tr><td class="paramname">suffixes</td><td>: List of extensions to check against. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The first matching location of an archived raw datafile, else an empty string. </dd></dl>

<p>Implements <a class="el" href="../../dc/df9/classMantid_1_1API_1_1IArchiveSearch.html#ab79feafa78b11135830e434bff3bd0b6">Mantid::API::IArchiveSearch</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../da/d6e/ORNLDataArchive_8cpp_source.html#l00099">99</a> of file <a class="el" href="../../da/d6e/ORNLDataArchive_8cpp_source.html">ORNLDataArchive.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../df/df2/Kernel_2src_2Logger_8cpp_source.html#l00114">Mantid::Kernel::Logger::debug()</a>, <a class="el" href="../../d9/da0/namespaceMantid_1_1API.html#a6f6a3554a6e8ce252c08527a12021fba">Mantid::API::g_log</a>, and <a class="el" href="../../de/d06/SingletonHolder_8h_source.html#l00091">Mantid::Kernel::SingletonHolder&lt; T &gt;::Instance()</a>.</p>

</div>
</div>
<a id="ac747a7ad9b631d26568d5a4466067f72" name="ac747a7ad9b631d26568d5a4466067f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac747a7ad9b631d26568d5a4466067f72">&#9670;&#160;</a></span>setONCat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mantid::DataHandling::ORNLDataArchive::setONCat </td>
          <td>(</td>
          <td class="paramtype">ONCat_uptr&#160;</td>
          <td class="paramname"><em>oncat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d6e/ORNLDataArchive_8cpp_source.html#l00198">198</a> of file <a class="el" href="../../da/d6e/ORNLDataArchive_8cpp_source.html">ORNLDataArchive.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html#l00038">m_oncat</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3c0369eea9c26d424bb259eedbff8624" name="a3c0369eea9c26d424bb259eedbff8624"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c0369eea9c26d424bb259eedbff8624">&#9670;&#160;</a></span>m_oncat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ONCat_uptr Mantid::DataHandling::ORNLDataArchive::m_oncat = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html#l00038">38</a> of file <a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html">ORNLDataArchive.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d6e/ORNLDataArchive_8cpp_source.html#l00198">setONCat()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Framework/DataHandling/inc/MantidDataHandling/<a class="el" href="../../dc/d83/ORNLDataArchive_8h_source.html">ORNLDataArchive.h</a></li>
<li>Framework/DataHandling/src/<a class="el" href="../../da/d6e/ORNLDataArchive_8cpp_source.html">ORNLDataArchive.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 3 2023 12:00:04 for Mantid by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
