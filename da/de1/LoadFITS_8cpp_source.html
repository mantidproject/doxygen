<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mantid: Framework/DataHandling/src/LoadFITS.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-59110517-2', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Mantid
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(1); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_bcbb2cf9a3d3d83e5515c82071a07177.html">Framework</a></li><li class="navelem"><a class="el" href="../../dir_9909f9f293bbfe8baaa1537c9331a49f.html">DataHandling</a></li><li class="navelem"><a class="el" href="../../dir_7727d9a2da0333d4395f22d09c5d2c16.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">LoadFITS.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../da/de1/LoadFITS_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Mantid Repository : https://github.com/mantidproject/mantid</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Copyright &amp;copy; 2018 ISIS Rutherford Appleton Laboratory UKRI,</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//   NScD Oak Ridge National Laboratory, European Spallation Source,</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">//   Institut Laue - Langevin &amp; CSNS, Institute of High Energy Physics, CAS</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// SPDX - License - Identifier: GPL - 3.0 +</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &quot;<a class="code" href="../../da/d30/LoadFITS_8h.html">MantidDataHandling/LoadFITS.h</a>&quot;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d17/FileProperty_8h.html">MantidAPI/FileProperty.h</a>&quot;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/d8f/MultipleFileProperty_8h.html">MantidAPI/MultipleFileProperty.h</a>&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/ddd/NumericAxis_8h.html">MantidAPI/NumericAxis.h</a>&quot;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/db4/RegisterFileLoader_8h.html">MantidAPI/RegisterFileLoader.h</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d49/Run_8h.html">MantidAPI/Run.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/d7b/WorkspaceFactory_8h.html">MantidAPI/WorkspaceFactory.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/db3/WorkspaceGroup_8h.html">MantidAPI/WorkspaceGroup.h</a>&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="../../d2/d95/Workspace2D_8h.html">MantidDataObjects/Workspace2D.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d4d/BoundedValidator_8h.html">MantidKernel/BoundedValidator.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/daf/Unit_8h.html">MantidKernel/Unit.h</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="../../d3/dfd/UnitFactory_8h.html">MantidKernel/UnitFactory.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;boost/algorithm/string.hpp&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;boost/scoped_array.hpp&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;Poco/BinaryReader.h&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;filesystem&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d8/d23/namespaceMantid_1_1DataHandling.html">Mantid::DataHandling</a>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../db/d22/namespaceMantid_1_1DataObjects.html">Mantid::DataObjects</a>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d9/da0/namespaceMantid_1_1API.html">Mantid::API</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d9/dec/namespaceMantid_1_1Kernel.html">Mantid::Kernel</a>;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> InterpretType&gt; <span class="keywordtype">double</span> toDouble(uint8_t *src) {</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>  <span class="comment">// cppcheck-suppress invalidPointerCast</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(*<span class="keyword">reinterpret_cast&lt;</span>InterpretType *<span class="keyword">&gt;</span>(src));</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>}</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>} <span class="comment">// namespace</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d8/d23/namespaceMantid_1_1DataHandling.html">Mantid::DataHandling</a> {</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">// Register the algorithm into the AlgorithmFactory</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><a class="code hl_define" href="../../d5/db4/RegisterFileLoader_8h.html#a2f226eb8da0d4adb411ba1400602ff86">DECLARE_FILELOADER_ALGORITHM</a>(<a class="code hl_class" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html">LoadFITS</a>)</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="foldopen" id="foldopen00047" data-start="{" data-end="};">
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">   47</a></span>struct <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> {</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a40a5ae1d69b263f9ec4624abf71e2be0">   48</a></span>  std::vector&lt;std::string&gt; <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a40a5ae1d69b263f9ec4624abf71e2be0">headerItems</a>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">   49</a></span>  std::map&lt;std::string, std::string&gt; <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">   50</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#acabafc85e72bf7390a160a4f600166f4">   51</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#acabafc85e72bf7390a160a4f600166f4">numberOfAxis</a>;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a7fa96ffe4c950f33c4c97e7b214d51c3">   52</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a7fa96ffe4c950f33c4c97e7b214d51c3">offset</a>;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">   53</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">headerSizeMultiplier</a>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">   54</a></span>  std::vector&lt;size_t&gt; <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#ac6bd18a273b57a12562a139d570e59ab">   55</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#ac6bd18a273b57a12562a139d570e59ab">scale</a>;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3e2d5a8687ddfcb0f8333dd7b7e3fcc7">   56</a></span>  std::string <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3e2d5a8687ddfcb0f8333dd7b7e3fcc7">imageKey</a>;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3a8a69b4a9020254a3a16027fbead8e7">   57</a></span>  std::string <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3a8a69b4a9020254a3a16027fbead8e7">extension</a>;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">   58</a></span>  std::string <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a>;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">   59</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>};</div>
</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="comment">// Static class constants</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac0e54d89a09fcb7d5f04409c4e272623">LoadFITS::g_END_KEYNAME</a> = <span class="stringliteral">&quot;END&quot;</span>;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5977ebd5f9308405dade1436235f58d5">LoadFITS::g_COMMENT_KEYNAME</a> = <span class="stringliteral">&quot;COMMENT&quot;</span>;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a4cbaad041c42e34ee638bc3306b96753">LoadFITS::g_XTENSION_KEYNAME</a> = <span class="stringliteral">&quot;XTENSION&quot;</span>;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a834acfba79a01028130d8958cff94121">LoadFITS::g_BIT_DEPTH_NAME</a> = <span class="stringliteral">&quot;BitDepthName&quot;</span>;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aca65fc9ea2551904a45be67580fca740">LoadFITS::g_ROTATION_NAME</a> = <span class="stringliteral">&quot;RotationName&quot;</span>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0d20b9525b555aa76e2bf8b019e68de8">LoadFITS::g_AXIS_NAMES_NAME</a> = <span class="stringliteral">&quot;AxisNames&quot;</span>;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac9e914beb9890f15a4280206f308d282">LoadFITS::g_IMAGE_KEY_NAME</a> = <span class="stringliteral">&quot;ImageKeyName&quot;</span>;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa43e1c04da1589005b0ba053ae1d293b">LoadFITS::g_HEADER_MAP_NAME</a> = <span class="stringliteral">&quot;HeaderMapFile&quot;</span>;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="keyword">const</span> std::string <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aab5edec8ba337fcd262c12aad488261c">LoadFITS::g_defaultImgType</a> = <span class="stringliteral">&quot;SAMPLE&quot;</span>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment">// Bits/bytes per pixel. Values fixed in the FITS standard</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a03269fb8eed38c7dc2090d19c25db866">LoadFITS::g_maxBitDepth</a> = 64;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a7d68e8a77ac7f413389a02887de91f46">LoadFITS::g_maxBytesPP</a> = g_maxBitDepth / 8;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="foldopen" id="foldopen00080" data-start="{" data-end="}">
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aabe236022548de26f8fdf898b31e9daf">   80</a></span><a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aabe236022548de26f8fdf898b31e9daf">LoadFITS::LoadFITS</a>()</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    : m_headerScaleKey(), m_headerOffsetKey(), m_headerBitDepthKey(), m_headerRotationKey(), m_headerImageKeyKey(),</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      m_headerAxisNameKeys(), m_mapFile(), m_pixelCount(0) {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8fd3cc92403065554df201b44e682df6">setupDefaultKeywordNames</a>();</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>}</div>
</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="foldopen" id="foldopen00092" data-start="{" data-end="}">
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2ccf68320351055110daf7934708310e">   92</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2ccf68320351055110daf7934708310e">LoadFITS::confidence</a>(<a class="code hl_class" href="../../dd/dab/classMantid_1_1Kernel_1_1FileDescriptor.html">Kernel::FileDescriptor</a> &amp;descriptor)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <span class="comment">// Should really improve this to check the file header (of first file at</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  <span class="comment">// least) to make sure it contains the fields wanted</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  <span class="keywordflow">return</span> (descriptor.<a class="code hl_function" href="../../dd/dab/classMantid_1_1Kernel_1_1FileDescriptor.html#acbe800aef1e22012855937dbc9bb7b44">extension</a>() == <span class="stringliteral">&quot;.fits&quot;</span> || descriptor.<a class="code hl_function" href="../../dd/dab/classMantid_1_1Kernel_1_1FileDescriptor.html#acbe800aef1e22012855937dbc9bb7b44">extension</a>() == <span class="stringliteral">&quot;.fit&quot;</span>) ? 80 : 0;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>}</div>
</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="foldopen" id="foldopen00102" data-start="{" data-end="}">
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a46009a238b9abc40485bb54aa9b0bf64">  102</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a46009a238b9abc40485bb54aa9b0bf64">LoadFITS::init</a>() {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <span class="comment">// Specify file extensions which can be associated with a FITS file.</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>  std::vector&lt;std::string&gt; exts, exts2;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <span class="comment">// Declare the Filename algorithm property. Mandatory. Sets the path to the</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  <span class="comment">// file to load.</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  exts.clear();</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  exts.emplace_back(<span class="stringliteral">&quot;.fits&quot;</span>);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  exts.emplace_back(<span class="stringliteral">&quot;.fit&quot;</span>);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  exts2.emplace_back(<span class="stringliteral">&quot;.*&quot;</span>);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(std::make_unique&lt;MultipleFileProperty&gt;(<span class="stringliteral">&quot;Filename&quot;</span>, exts),</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                  <span class="stringliteral">&quot;The name of the input file (note that you can give &quot;</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                  <span class="stringliteral">&quot;multiple file names separated by commas).&quot;</span>);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      std::make_unique&lt;<a class="code hl_class" href="../../df/d44/classMantid_1_1API_1_1WorkspaceProperty.html">API::WorkspaceProperty&lt;API::Workspace&gt;</a>&gt;(<span class="stringliteral">&quot;OutputWorkspace&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_enumvalue" href="../../d6/de8/structMantid_1_1Kernel_1_1Direction.html#a72f530370990b8f552ac26dc8d6f433fac3cd74bb9eb7553812c23134bb561418">Kernel::Direction::Output</a>));</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(std::make_unique&lt;<a class="code hl_class" href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">Kernel::PropertyWithValue&lt;bool&gt;</a>&gt;(<span class="stringliteral">&quot;LoadAsRectImg&quot;</span>, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d6/de8/structMantid_1_1Kernel_1_1Direction.html#a72f530370990b8f552ac26dc8d6f433fa94629ab0db6cc6a46f605cf640920474">Kernel::Direction::Input</a>),</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                  <span class="stringliteral">&quot;If enabled (not by default), the output Workspace2D will have &quot;</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                  <span class="stringliteral">&quot;one histogram per row and one bin per pixel, such that a 2D &quot;</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                  <span class="stringliteral">&quot;color plot (color fill plot) will display an image.&quot;</span>);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  <span class="keyword">auto</span> zeroOrPosDbl = std::make_shared&lt;BoundedValidator&lt;double&gt;&gt;();</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  zeroOrPosDbl-&gt;setLower(0.0);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(<span class="stringliteral">&quot;FilterNoiseLevel&quot;</span>, 0.0, zeroOrPosDbl, <span class="stringliteral">&quot;Threshold to remove noisy pixels. Try 50 for example.&quot;</span>);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  <span class="keyword">auto</span> posInt = std::make_shared&lt;BoundedValidator&lt;int&gt;&gt;();</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  posInt-&gt;setLower(1);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(<span class="stringliteral">&quot;BinSize&quot;</span>, 1, posInt,</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                  <span class="stringliteral">&quot;Rebunch n*n on both axes, generating pixels with sums of &quot;</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                  <span class="stringliteral">&quot;blocks of n by n original pixels.&quot;</span>);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>  <span class="keyword">auto</span> posDbl = std::make_shared&lt;BoundedValidator&lt;double&gt;&gt;();</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  posDbl-&gt;setLower(std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(<span class="stringliteral">&quot;Scale&quot;</span>, 80.0, posDbl, <span class="stringliteral">&quot;Pixels per cm.&quot;</span>, <a class="code hl_enumvalue" href="../../d6/de8/structMantid_1_1Kernel_1_1Direction.html#a72f530370990b8f552ac26dc8d6f433fa94629ab0db6cc6a46f605cf640920474">Kernel::Direction::Input</a>);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">declareProperty</a>(std::make_unique&lt;FileProperty&gt;(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa43e1c04da1589005b0ba053ae1d293b">g_HEADER_MAP_NAME</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_enumvalue" href="../../d8/d3b/classMantid_1_1API_1_1FileProperty.html#afea15d5ce8f5a4d64f12e0e3b85f5d12acdd20a88b77c992ea30de80c7e7698f5">FileProperty::OptionalDirectory</a>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                                                 <a class="code hl_enumvalue" href="../../d6/de8/structMantid_1_1Kernel_1_1Direction.html#a72f530370990b8f552ac26dc8d6f433fa94629ab0db6cc6a46f605cf640920474">Kernel::Direction::Input</a>),</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                  <span class="stringliteral">&quot;A file mapping header key names to non-standard names [line separated &quot;</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                  <span class="stringliteral">&quot;values in the format KEY=VALUE, e.g. BitDepthName=BITPIX] - do not use &quot;</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                  <span class="stringliteral">&quot;this if you want to keep compatibility with standard FITS files.&quot;</span>);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>}</div>
</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="foldopen" id="foldopen00150" data-start="{" data-end="}">
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a09ba9cee53cbb0b0fd2751e66435f671">  150</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a09ba9cee53cbb0b0fd2751e66435f671">LoadFITS::exec</a>() {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <span class="comment">// for non-standard headers, by default won&#39;t do anything</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abf500c01f62758fc5806b5109a58b4c7">mapHeaderKeys</a>();</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  std::string fName = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a3f42e205cfdb677cc2b4033e4f2ef3da">getPropertyValue</a>(<span class="stringliteral">&quot;Filename&quot;</span>);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  std::vector&lt;std::string&gt; paths;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  boost::split(paths, fName, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <span class="keywordtype">int</span> binSize = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a5356ea547c4381e4144caa2b37599ead">getProperty</a>(<span class="stringliteral">&quot;BinSize&quot;</span>);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <span class="keywordtype">double</span> noiseThresh = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a5356ea547c4381e4144caa2b37599ead">getProperty</a>(<span class="stringliteral">&quot;FilterNoiseLevel&quot;</span>);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>  <span class="keywordtype">bool</span> loadAsRectImg = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a5356ea547c4381e4144caa2b37599ead">getProperty</a>(<span class="stringliteral">&quot;LoadAsRectImg&quot;</span>);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="keyword">const</span> std::string outWSName = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a3f42e205cfdb677cc2b4033e4f2ef3da">getPropertyValue</a>(<span class="stringliteral">&quot;OutputWorkspace&quot;</span>);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a25af10d16b69342b849bd65a97cdfab5">doLoadFiles</a>(paths, outWSName, loadAsRectImg, binSize, noiseThresh);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>}</div>
</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="foldopen" id="foldopen00166" data-start="{" data-end="}">
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac7410832d0df098e62583b9a322a633d">  166</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac7410832d0df098e62583b9a322a633d">LoadFITS::loadHeader</a>(<span class="keyword">const</span> std::string &amp;filePath, <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;header) {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  header.extension = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  header.filePath = filePath;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  <span class="comment">// Get various pieces of information from the file header which are used</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  <span class="comment">// to</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  <span class="comment">// create the workspace</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa50e837acc8d222168ca3c49ab3724b4">parseHeader</a>(header);</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="comment">// Unable to parse the header, throw.</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Severe problem found while parsing the header of &quot;</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                             <span class="stringliteral">&quot;this FITS file (&quot;</span> +</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                             filePath + <span class="stringliteral">&quot;). This file may not be standard FITS. Error description: &quot;</span> + e.what());</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  }</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <span class="comment">// Get and convert specific MANDATORY standard header values which</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  <span class="comment">// will are needed to know how to load the data: BITPIX, NAXIS,</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="comment">// NAXISi (where i = 1..NAXIS, e.g. NAXIS2 for two axis).</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    std::string tmpBitPix = header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">m_headerBitDepthKey</a>];</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="keywordflow">if</span> (boost::contains(tmpBitPix, <span class="stringliteral">&quot;-&quot;</span>)) {</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      boost::erase_all(tmpBitPix, <span class="stringliteral">&quot;-&quot;</span>);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>      header.isFloat = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>      header.isFloat = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    }</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>      header.bitsPerPixel = boost::lexical_cast&lt;int&gt;(tmpBitPix);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Coult not interpret the entry number of bits per pixel (&quot;</span> + <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">m_headerBitDepthKey</a> +</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                               <span class="stringliteral">&quot;) as an integer. Error: &quot;</span> + e.what());</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="comment">// Check that the files use valid BITPIX values</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="comment">// http://archive.stsci.edu/fits/fits_standard/node39.html#SECTION00941000000000000000</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="keywordflow">if</span> (header.bitsPerPixel != 8 &amp;&amp; header.bitsPerPixel != 16 &amp;&amp; header.bitsPerPixel != 32 &amp;&amp; header.bitsPerPixel != 64)</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>      <span class="comment">// this implicitly includes when &#39;header.bitsPerPixel &gt;</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>      <span class="comment">// g_maxBitDepth&#39;</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;This algorithm only supports 8, 16, 32 or 64 &quot;</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                               <span class="stringliteral">&quot;bits per pixel as allowed in the FITS standard. The header of &quot;</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                               <span class="stringliteral">&quot;file &#39;&quot;</span> +</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                               filePath + <span class="stringliteral">&quot;&#39; says that its bit depth is: &quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(header.bitsPerPixel));</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Failed to process the &#39;&quot;</span> + <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">m_headerBitDepthKey</a> +</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                             <span class="stringliteral">&quot;&#39; entry (bits per pixel) in the header of this file: &quot;</span> + filePath +</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                             <span class="stringliteral">&quot;. Error description: &quot;</span> + e.what());</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  }</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="comment">// Add the image key, use the value in the FITS header if found,</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="comment">// otherwise default (to SAMPLE).</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keyword">auto</span> it = header.headerKeys.find(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5a1ffe72c47d76e942be1ba235f2586d">m_headerImageKeyKey</a>);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    <span class="keywordflow">if</span> (header.headerKeys.end() != it) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      header.imageKey = it-&gt;second;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      header.imageKey = <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aab5edec8ba337fcd262c12aad488261c">g_defaultImgType</a>;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Failed to process the &#39;&quot;</span> + <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5a1ffe72c47d76e942be1ba235f2586d">m_headerImageKeyKey</a> +</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                             <span class="stringliteral">&quot;&#39; entry (type of image: sample, dark, open) in &quot;</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                             <span class="stringliteral">&quot;the header of this file: &quot;</span> +</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                             filePath + <span class="stringliteral">&quot;. Error description: &quot;</span> + e.what());</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    header.numberOfAxis = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>.size());</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; header.numberOfAxis; ++j) {</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>      header.axisPixelLengths.emplace_back(boost::lexical_cast&lt;size_t&gt;(header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>[j]]));</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      <span class="comment">// only debug level, when loading multiple files this is very verbose</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>      <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a20b305765f9c40ef2d3004c0d09feb4a">debug</a>() &lt;&lt; <span class="stringliteral">&quot;Found axis length header entry: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>[j] &lt;&lt; <span class="stringliteral">&quot; = &quot;</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                    &lt;&lt; header.axisPixelLengths.back() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// Various extensions to the FITS format are used elsewhere, and</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="comment">// must be parsed differently if used. This loader Loader</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="comment">// doesn&#39;t support this.</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    header.extension = header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a4cbaad041c42e34ee638bc3306b96753">g_XTENSION_KEYNAME</a>];</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Failed to process the &#39;&quot;</span> + <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a233be3a2ea4a8527af6abd6a42e9a564">m_headerNAxisNameKey</a> +</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                             <span class="stringliteral">&quot;&#39; entries (dimensions) in the header of this file: &quot;</span> + filePath +</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                             <span class="stringliteral">&quot;. Error description: &quot;</span> + e.what());</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <span class="comment">// scale parameter, header BSCALE in the fits standard</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  <span class="keywordflow">if</span> (header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aac45e4e3aafa778b827ee4638ca6c109">m_headerScaleKey</a>].empty()) {</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    header.scale = 1;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>      header.scale = boost::lexical_cast&lt;double&gt;(header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aac45e4e3aafa778b827ee4638ca6c109">m_headerScaleKey</a>]);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Coult not interpret the entry number of bits per pixel (&quot;</span> + <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">m_headerBitDepthKey</a> +</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>                               <span class="stringliteral">&quot; = &quot;</span> + header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aac45e4e3aafa778b827ee4638ca6c109">m_headerScaleKey</a>] +</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                               <span class="stringliteral">&quot;) as a floating point number (double). Error: &quot;</span> + e.what());</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>  }</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>  <span class="comment">// data offsset parameter, header BZERO in the fits standard</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  <span class="keywordflow">if</span> (header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a>].empty()) {</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    header.offset = 0;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      header.offset = boost::lexical_cast&lt;int&gt;(header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a>]);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    } <span class="keywordflow">catch</span> (std::exception &amp; <span class="comment">/*e*/</span>) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>      <span class="comment">// still, second try with floating point format (as used for example</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      <span class="comment">// by</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <span class="comment">// Starlight XPRESS cameras)</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        <span class="keyword">auto</span> doff = boost::lexical_cast&lt;double&gt;(header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a>]);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <span class="keywordtype">double</span> intPart;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <span class="keywordflow">if</span> (0 != modf(doff, &amp;intPart)) {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>          <span class="comment">// anyway we&#39;ll do a cast, but warn if there was a fraction</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>          <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a6e1ec105dbc2d5ef5430fe6a3a325f8b">warning</a>() &lt;&lt; <span class="stringliteral">&quot;The value given in the FITS header entry for the data &quot;</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>                             <span class="stringliteral">&quot;offset (&quot;</span> +</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                                 <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a> + <span class="stringliteral">&quot; = &quot;</span> + header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a>] +</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                                 <span class="stringliteral">&quot;) has a fractional part, and it will be ignored!\n&quot;</span>;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        }</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        header.offset = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(doff);</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Coult not interpret the entry number of data offset (&quot;</span> + <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a> + <span class="stringliteral">&quot; = &quot;</span> +</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>                                 header.headerKeys[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a>] +</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                                 <span class="stringliteral">&quot;) as an integer number nor a floating point &quot;</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>                                 <span class="stringliteral">&quot;number (double). Error: &quot;</span> +</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                                 e.what());</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>      }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>  }</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>}</div>
</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="foldopen" id="foldopen00310" data-start="{" data-end="}">
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a54e04660d7e858ed7b0b01b22b1ddf74">  310</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a54e04660d7e858ed7b0b01b22b1ddf74">LoadFITS::headerSanityCheck</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;hdr, <span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;hdrFirst) {</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <span class="keywordflow">if</span> (!hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3a8a69b4a9020254a3a16027fbead8e7">extension</a>.empty()) {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    valid = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a56bbdfffa5a708ee5b613a82f1f0ab1a">error</a>() &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a> &lt;&lt; <span class="stringliteral">&quot;: extensions found in the header.\n&quot;</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  <span class="keywordflow">if</span> (hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#acabafc85e72bf7390a160a4f600166f4">numberOfAxis</a> != 2) {</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    valid = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a56bbdfffa5a708ee5b613a82f1f0ab1a">error</a>() &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a> &lt;&lt; <span class="stringliteral">&quot;: the number of axes is not 2 but: &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#acabafc85e72bf7390a160a4f600166f4">numberOfAxis</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <span class="comment">// Test current item has same axis values as first item.</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <span class="keywordflow">if</span> (hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0] != hdrFirst.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0]) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    valid = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a56bbdfffa5a708ee5b613a82f1f0ab1a">error</a>() &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>                  &lt;&lt; <span class="stringliteral">&quot;: the number of pixels in the first dimension differs &quot;</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>                     <span class="stringliteral">&quot;from the first file loaded (&quot;</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>                  &lt;&lt; hdrFirst.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a> &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0] &lt;&lt; <span class="stringliteral">&quot; != &quot;</span> &lt;&lt; hdrFirst.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0]</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>                  &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>  }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>  <span class="keywordflow">if</span> (hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1] != hdrFirst.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1]) {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    valid = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a56bbdfffa5a708ee5b613a82f1f0ab1a">error</a>() &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>                  &lt;&lt; <span class="stringliteral">&quot;: the number of pixels in the second dimension differs&quot;</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>                     <span class="stringliteral">&quot;from the first file loaded (&quot;</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>                  &lt;&lt; hdrFirst.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a> &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0] &lt;&lt; <span class="stringliteral">&quot; != &quot;</span> &lt;&lt; hdrFirst.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0]</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>                  &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>  }</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>  <span class="comment">// Check the format is correct and create the Workspace</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  <span class="keywordflow">if</span> (!valid) {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="comment">// Invalid files, record error</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;An issue has been found in the header of this FITS file: &quot;</span> + hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a> +</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>                             <span class="stringliteral">&quot;. This algorithm currently doesn&#39;t support FITS files with &quot;</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>                             <span class="stringliteral">&quot;non-standard extensions, more than two axis &quot;</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>                             <span class="stringliteral">&quot;of data, or has detected that all the files are &quot;</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>                             <span class="stringliteral">&quot;not similar.&quot;</span>);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>  }</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>}</div>
</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span> </div>
<div class="foldopen" id="foldopen00369" data-start="{" data-end="}">
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a25af10d16b69342b849bd65a97cdfab5">  369</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a25af10d16b69342b849bd65a97cdfab5">LoadFITS::doLoadFiles</a>(<span class="keyword">const</span> std::vector&lt;std::string&gt; &amp;paths, <span class="keyword">const</span> std::string &amp;outWSName, <span class="keywordtype">bool</span> loadAsRectImg,</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>                           <span class="keywordtype">int</span> binSize, <span class="keywordtype">double</span> noiseThresh) {</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>  std::vector&lt;FITSInfo&gt; headers;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>  headers.resize(paths.size());</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac7410832d0df098e62583b9a322a633d">loadHeader</a>(paths[0], headers[0]);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>  <span class="comment">// No extension is set -&gt; it&#39;s the standard format which we can parse.</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <span class="keywordflow">if</span> (headers[0].numberOfAxis &gt; 0)</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">m_pixelCount</a> += headers[0].axisPixelLengths[0];</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>  <span class="comment">// Presumably 2 axis, but futureproofing.</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; headers[0].numberOfAxis; ++i) {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">m_pixelCount</a> *= headers[0].axisPixelLengths[i];</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>  }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="comment">// Check consistency of binSize asap</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; headers[0].numberOfAxis; ++i) {</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordflow">if</span> (0 != (headers[0].axisPixelLengths[i] % binSize)) {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Cannot rebin this image in blocks of &quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(binSize) + <span class="stringliteral">&quot; x &quot;</span> +</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                               <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(binSize) + <span class="stringliteral">&quot; pixels as requested because the size of dimension &quot;</span> +</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>                               <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(i + 1) + <span class="stringliteral">&quot; (&quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(headers[0].axisPixelLengths[i]) +</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>                               <span class="stringliteral">&quot;) is not a multiple of the bin size.&quot;</span>);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    }</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>  }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>  <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> imageY(headers[0].axisPixelLengths[1], std::vector&lt;double&gt;(headers[0].axisPixelLengths[0]));</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>  <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> imageE(headers[0].axisPixelLengths[1], std::vector&lt;double&gt;(headers[0].axisPixelLengths[0]));</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>  <span class="keywordtype">size_t</span> bytes = (headers[0].bitsPerPixel / 8) * <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">m_pixelCount</a>;</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>  std::vector&lt;char&gt; buffer;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    buffer.resize(bytes);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  } <span class="keywordflow">catch</span> (std::exception &amp;) {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Could not allocate enough memory to run when trying to allocate &quot;</span> +</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                             <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(bytes) + <span class="stringliteral">&quot; bytes.&quot;</span>);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>  <span class="comment">// Create a group for these new workspaces, if the group already exists, add</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>  <span class="comment">// to it.</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>  <span class="keywordtype">size_t</span> fileNumberInGroup = 0;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>  <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a2177621ba264b5d9d0c8a605e85c0058">WorkspaceGroup_sptr</a> wsGroup;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>  <span class="keywordflow">if</span> (<span class="keyword">auto</span> &amp;ads = AnalysisDataService::Instance(); ads.doesExist(outWSName)) {</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <span class="comment">// Get the name of the latest file in group to start numbering from</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    wsGroup = ads.retrieveWS&lt;<a class="code hl_class" href="../../d9/de9/classMantid_1_1API_1_1WorkspaceGroup.html">WorkspaceGroup</a>&gt;(outWSName);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    std::string latestName = wsGroup-&gt;<a class="code hl_function" href="../../d9/de9/classMantid_1_1API_1_1WorkspaceGroup.html#ab8e78d1f1e48cff0320783cacf44ad83">getNames</a>().back();</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="comment">// Set next file number</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    fileNumberInGroup = <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abcbe7b476dc62231d08ed6de18014e3a">fetchNumber</a>(latestName) + 1;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    wsGroup = std::make_shared&lt;WorkspaceGroup&gt;();</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    wsGroup-&gt;setTitle(outWSName);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> totalWS = headers.size();</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>  <span class="comment">// Create a progress reporting object</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  <a class="code hl_class" href="../../de/dd6/classMantid_1_1API_1_1Progress.html">API::Progress</a> <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a7ac471ebfae5ff09e8423fba191f09fd">progress</a>(<span class="keyword">this</span>, 0.0, 1.0, totalWS + 1);</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a7ac471ebfae5ff09e8423fba191f09fd">progress</a>.report(0, <span class="stringliteral">&quot;Loading file(s) into workspace(s)&quot;</span>);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>  <span class="comment">// Create first workspace (with instrument definition). This is also used as</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>  <span class="comment">// a template for creating others</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>  <a class="code hl_typedef" href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Workspace2D_sptr</a> imgWS;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  imgWS =</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a862c7b7d3df60b1185ecd6b4980b6c08">makeWorkspace</a>(headers[0], fileNumberInGroup, buffer, imageY, imageE, imgWS, loadAsRectImg, binSize, noiseThresh);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>  <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a7ac471ebfae5ff09e8423fba191f09fd">progress</a>.report(1, <span class="stringliteral">&quot;First file loaded.&quot;</span>);</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  wsGroup-&gt;addWorkspace(imgWS);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ae993fb404f1da11141a06b6b673a09a4">isInstrOtherThanIMAT</a>(headers[0])) {</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="comment">// For now we assume IMAT except when specific headers are found by</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="comment">// isInstrOtherThanIMAT()</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="comment">// TODO: do this conditional on INSTR=&#39;IMAT&#39; when we have proper IMAT .fits</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="comment">// files</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>      <span class="keyword">auto</span> loadInst = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a601ae146d6e558587e743cfad107e6bd">createChildAlgorithm</a>(<span class="stringliteral">&quot;LoadInstrument&quot;</span>);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>      std::string directoryName = Kernel::ConfigService::Instance().getInstrumentDirectory();</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      directoryName = directoryName + <span class="stringliteral">&quot;/IMAT_Definition.xml&quot;</span>;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>      loadInst-&gt;setPropertyValue(<span class="stringliteral">&quot;Filename&quot;</span>, directoryName);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      loadInst-&gt;setProperty&lt;<a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#af3d93880dabd4c45bfdebcaadd27b2fa">MatrixWorkspace_sptr</a>&gt;(<span class="stringliteral">&quot;Workspace&quot;</span>, std::dynamic_pointer_cast&lt;MatrixWorkspace&gt;(imgWS));</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>      loadInst-&gt;execute();</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    } <span class="keywordflow">catch</span> (std::exception &amp;ex) {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>      <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#ad1469533f03502f2d0f14cf3456f4ef3">information</a>(<span class="stringliteral">&quot;Cannot load the instrument definition. &quot;</span> + std::string(ex.what()));</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    }</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  }</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <span class="comment">// don&#39;t feel tempted to parallelize this loop as it is - it uses the same</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <span class="comment">// imageY and imageE buffers for all the workspaces</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  <span class="keywordflow">for</span> (int64_t i = 1; i &lt; static_cast&lt;int64_t&gt;(totalWS); ++i) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac7410832d0df098e62583b9a322a633d">loadHeader</a>(paths[i], headers[i]);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    <span class="comment">// Check each header is valid/supported: standard (no extension to</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <span class="comment">// FITS), has two axis, and it is consistent with the first header</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a54e04660d7e858ed7b0b01b22b1ddf74">headerSanityCheck</a>(headers[i], headers[0]);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    imgWS = <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a862c7b7d3df60b1185ecd6b4980b6c08">makeWorkspace</a>(headers[i], fileNumberInGroup, buffer, imageY, imageE, imgWS, loadAsRectImg, binSize,</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>                          noiseThresh);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a7ac471ebfae5ff09e8423fba191f09fd">progress</a>.report(<span class="stringliteral">&quot;Loaded file &quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(i + 1) + <span class="stringliteral">&quot; of &quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(totalWS));</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    wsGroup-&gt;addWorkspace(imgWS);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  }</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>  <a class="code hl_function" href="../../d9/dc0/classMantid_1_1Kernel_1_1IPropertyManager.html#a3819af9d65d799ec151ab97c15f147e4">setProperty</a>(<span class="stringliteral">&quot;OutputWorkspace&quot;</span>, wsGroup);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>}</div>
</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="foldopen" id="foldopen00498" data-start="{" data-end="}">
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa50e837acc8d222168ca3c49ab3724b4">  498</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa50e837acc8d222168ca3c49ab3724b4">LoadFITS::parseHeader</a>(<a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;headerInfo) {</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>  headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">headerSizeMultiplier</a> = 0;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  std::ifstream istr(headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a>.c_str(), std::ios::binary);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  istr.seekg(0, istr.end);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <span class="keyword">const</span> std::streampos fileSize = istr.tellg();</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <span class="keywordflow">if</span> (fileSize &lt;= 0) {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Found a file that is readable but empty (0 bytes size): &quot;</span> + headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a>);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  }</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  istr.seekg(0, istr.beg);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  Poco::BinaryReader reader(istr);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="comment">// Iterate 80 bytes at a time until header is parsed | 2880 bytes is the</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  <span class="comment">// fixed header length of FITS</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <span class="comment">// 2880/80 = 36 iterations required</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keyword">const</span> std::string commentKW = <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5977ebd5f9308405dade1436235f58d5">g_COMMENT_KEYNAME</a>;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>  <span class="keywordtype">bool</span> endFound = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <span class="keywordflow">while</span> (!endFound &amp;&amp; (<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a1d219adcd9453db7b2f2d93f37fb6568">g_BASE_HEADER_SIZE</a> * headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">headerSizeMultiplier</a> &lt; fileSize)) {</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">headerSizeMultiplier</a>++;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> entriesPerHDU = 36;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; entriesPerHDU; ++i) {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>      <span class="comment">// Keep vect of each header item, including comments, and also keep a</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <span class="comment">// map of individual keys.</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      std::string part;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>      reader.readRaw(80, part);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a40a5ae1d69b263f9ec4624abf71e2be0">headerItems</a>.emplace_back(part);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      <span class="comment">// from the FITS standard about COMMENT: This keyword shall have no</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      <span class="comment">// associated value; columns 9-80 may contain any ASCII text.</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>      <span class="comment">// That includes &#39;=&#39;</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>      <span class="keywordflow">if</span> (boost::iequals(commentKW, part.substr(0, commentKW.size()))) {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>      <span class="comment">// Add non-comment key/values. These hey and value are separated by the</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>      <span class="comment">// character &#39;=&#39;. All keys should be unique.</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>      <span class="comment">// This will simply and silenty ignore any entry without the &#39;=&#39;</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>      <span class="keyword">auto</span> eqPos = part.find(<span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>      <span class="keywordflow">if</span> (eqPos &gt; 0) {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        std::string key = part.substr(0, eqPos);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        std::string <a class="code hl_variable" href="../../d5/d0b/FitMW_8cpp.html#aee90379adb0307effb138f4871edbc5c">value</a> = part.substr(eqPos + 1);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="comment">// Comments on header entries are added after the value separated by a /</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        <span class="comment">// symbol. Exclude those comments.</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span> pos = <a class="code hl_variable" href="../../d5/d0b/FitMW_8cpp.html#aee90379adb0307effb138f4871edbc5c">value</a>.find(<span class="charliteral">&#39;/&#39;</span>); pos != std::string::npos &amp;&amp; pos &gt; 0)</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>          <a class="code hl_variable" href="../../d5/d0b/FitMW_8cpp.html#aee90379adb0307effb138f4871edbc5c">value</a>.erase(pos);</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        boost::trim(key);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        boost::trim(<a class="code hl_variable" href="../../d5/d0b/FitMW_8cpp.html#aee90379adb0307effb138f4871edbc5c">value</a>);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        <span class="keywordflow">if</span> (key == <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac0e54d89a09fcb7d5f04409c4e272623">g_END_KEYNAME</a>)</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>          endFound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <span class="keywordflow">if</span> (!key.empty())</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>          headerInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>[key] = <a class="code hl_variable" href="../../d5/d0b/FitMW_8cpp.html#aee90379adb0307effb138f4871edbc5c">value</a>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>      }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    }</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  }</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  <span class="keywordflow">if</span> (!endFound) {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Could not find any valid END entry in the headers of this file after &quot;</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                             <span class="stringliteral">&quot;scanning the file (&quot;</span> +</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                             <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(fileSize) +</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>                             <span class="stringliteral">&quot; bytes). This does not look like a valid FITS file and &quot;</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>                             <span class="stringliteral">&quot;it is not possible to read it correctly as the boundary between &quot;</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                             <span class="stringliteral">&quot;the headers and the data is undefined.&quot;</span>);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>  }</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  istr.close();</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>}</div>
</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="foldopen" id="foldopen00597" data-start="{" data-end="}">
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a862c7b7d3df60b1185ecd6b4980b6c08">  597</a></span><a class="code hl_typedef" href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Workspace2D_sptr</a> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a862c7b7d3df60b1185ecd6b4980b6c08">LoadFITS::makeWorkspace</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;fileInfo, <span class="keywordtype">size_t</span> &amp;newFileNumber, std::vector&lt;char&gt; &amp;buffer,</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>                                         <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageY, <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageE, <span class="keyword">const</span> <a class="code hl_typedef" href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Workspace2D_sptr</a> &amp;parent,</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>                                         <span class="keywordtype">bool</span> loadAsRectImg, <span class="keywordtype">int</span> binSize, <span class="keywordtype">double</span> noiseThresh) {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  <span class="comment">// Create workspace (taking into account already here if rebinning is</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  <span class="comment">// going to happen)</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  <a class="code hl_typedef" href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Workspace2D_sptr</a> ws;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  <span class="keywordflow">if</span> (!parent) {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    <span class="keywordflow">if</span> (!loadAsRectImg) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>      <span class="keywordtype">size_t</span> finalPixelCount = <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">m_pixelCount</a> / binSize * binSize;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      ws = std::dynamic_pointer_cast&lt;Workspace2D&gt;(</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>          <a class="code hl_function" href="../../d1/d8d/classMantid_1_1Kernel_1_1SingletonHolder.html#af5baabb0203c9b8be209ebd60dc82863">WorkspaceFactory::Instance</a>().<a class="code hl_function" href="../../db/d22/namespaceMantid_1_1DataObjects.html#ada9e481cb775152f9a3a3bef1df129ec">create</a>(<span class="stringliteral">&quot;Workspace2D&quot;</span>, finalPixelCount, 2, 1));</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      ws = std::dynamic_pointer_cast&lt;Workspace2D&gt;(</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>          <a class="code hl_function" href="../../d1/d8d/classMantid_1_1Kernel_1_1SingletonHolder.html#af5baabb0203c9b8be209ebd60dc82863">WorkspaceFactory::Instance</a>().<a class="code hl_function" href="../../db/d22/namespaceMantid_1_1DataObjects.html#ada9e481cb775152f9a3a3bef1df129ec">create</a>(<span class="stringliteral">&quot;Workspace2D&quot;</span>,</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>                                              fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1] / binSize,     <span class="comment">// one bin per column</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>                                              fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0] / binSize + 1, <span class="comment">// one spectrum per row</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                                              fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0] / binSize));</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    ws = std::dynamic_pointer_cast&lt;Workspace2D&gt;(<a class="code hl_function" href="../../d1/d8d/classMantid_1_1Kernel_1_1SingletonHolder.html#af5baabb0203c9b8be209ebd60dc82863">WorkspaceFactory::Instance</a>().<a class="code hl_function" href="../../db/d22/namespaceMantid_1_1DataObjects.html#ada9e481cb775152f9a3a3bef1df129ec">create</a>(parent));</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>  }</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>  <span class="comment">// this pixel scale property is used to set the workspace X values</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  <span class="keywordtype">double</span> cm_1 = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a5356ea547c4381e4144caa2b37599ead">getProperty</a>(<span class="stringliteral">&quot;Scale&quot;</span>);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>  <span class="comment">// amount of width units (e.g. cm) per pixel</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  <span class="keywordtype">double</span> cmpp = 1; <span class="comment">// cm per pixel == bin width</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>  <span class="keywordflow">if</span> (0.0 != cm_1)</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    cmpp /= cm_1;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  cmpp *= <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(binSize);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  <span class="keywordflow">if</span> (loadAsRectImg &amp;&amp; 1 == binSize) {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    <span class="comment">// set data directly into workspace</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a705d2ad118524641091dd71d5baad62c">readDataToWorkspace</a>(fileInfo, cmpp, ws, buffer);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8763b2c4bf0e9c637803aaebb570e49a">readDataToImgs</a>(fileInfo, imageY, imageE, buffer);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2fc57c4c89288b8f19de5e64cb7645b9">doFilterNoise</a>(noiseThresh, imageY, imageE);</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="comment">// Note this can change the sizes of the images and the number of pixels</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="keywordflow">if</span> (1 == binSize) {</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      ws-&gt;setImageYAndE(imageY, imageE, 0, loadAsRectImg, cmpp, <span class="keyword">false</span> <span class="comment">/* no parallel load */</span>);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> rebinnedY(imageY.size() / binSize, std::vector&lt;double&gt;(imageY[0].size() / binSize));</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> rebinnedE(imageE.size() / binSize, std::vector&lt;double&gt;(imageE[0].size() / binSize));</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span> </div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a938a242c59e2ddd966c8adcf127ce16f">doRebin</a>(binSize, imageY, imageE, rebinnedY, rebinnedE);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>      ws-&gt;setImageYAndE(rebinnedY, rebinnedE, 0, loadAsRectImg, cmpp, <span class="keyword">false</span> <span class="comment">/* no parallel load */</span>);</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    }</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>  }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    ws-&gt;setTitle(std::filesystem::path(fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a>).filename().string());</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>  } <span class="keywordflow">catch</span> (std::runtime_error &amp;) {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    ws-&gt;setTitle(<a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a17415dc3537b724fad046a3d03d91030">padZeros</a>(newFileNumber, <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a6c3142b6cc47c3ae5372d9d107a6f5cb">g_DIGIT_SIZE_APPEND</a>));</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>  }</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  ++newFileNumber;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span> </div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ace2c2098c976feb8ab0c3c2a7ffb43a0">addAxesInfoAndLogs</a>(ws, loadAsRectImg, fileInfo, binSize, cmpp);</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="keywordflow">return</span> ws;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>}</div>
</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="foldopen" id="foldopen00675" data-start="{" data-end="}">
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ace2c2098c976feb8ab0c3c2a7ffb43a0">  675</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ace2c2098c976feb8ab0c3c2a7ffb43a0">LoadFITS::addAxesInfoAndLogs</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Workspace2D_sptr</a> &amp;ws, <span class="keywordtype">bool</span> loadAsRectImg, <span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;fileInfo, <span class="keywordtype">int</span> binSize,</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                                  <span class="keywordtype">double</span> cmpp) {</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>  <span class="comment">// add axes</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  <span class="keywordtype">size_t</span> width = fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0] / binSize;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="../../d6/d64/GetAllEi_8cpp.html#a89f6abd564014faeff7cd20c340a9c7d">height</a> = fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1] / binSize;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  <span class="keywordflow">if</span> (loadAsRectImg) {</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    <span class="comment">// width/X axis</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    <span class="keyword">auto</span> axw = std::make_unique&lt;Mantid::API::NumericAxis&gt;(width + 1);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    axw-&gt;title() = <span class="stringliteral">&quot;width&quot;</span>;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; width + 1; i++) {</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>      axw-&gt;setValue(i, <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(i) * cmpp);</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>    }</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    ws-&gt;replaceAxis(0, std::move(axw));</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <span class="comment">// &quot;cm&quot; width label unit</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>    std::shared_ptr&lt;Kernel::Units::Label&gt; unitLbl =</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        std::dynamic_pointer_cast&lt;Kernel::Units::Label&gt;(UnitFactory::Instance().<a class="code hl_function" href="../../db/d22/namespaceMantid_1_1DataObjects.html#ada9e481cb775152f9a3a3bef1df129ec">create</a>(<span class="stringliteral">&quot;Label&quot;</span>));</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    unitLbl-&gt;setLabel(<span class="stringliteral">&quot;width&quot;</span>, <span class="stringliteral">&quot;cm&quot;</span>);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    ws-&gt;getAxis(0)-&gt;unit() = unitLbl;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="comment">// height/Y axis</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <span class="keyword">auto</span> axh = std::make_unique&lt;Mantid::API::NumericAxis&gt;(<a class="code hl_variable" href="../../d6/d64/GetAllEi_8cpp.html#a89f6abd564014faeff7cd20c340a9c7d">height</a>);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    axh-&gt;title() = <span class="stringliteral">&quot;height&quot;</span>;</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="../../d6/d64/GetAllEi_8cpp.html#a89f6abd564014faeff7cd20c340a9c7d">height</a>; i++) {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>      axh-&gt;setValue(i, <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(i) * cmpp);</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    }</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>    ws-&gt;replaceAxis(1, std::move(axh));</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <span class="comment">// &quot;cm&quot; height label unit</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    unitLbl = std::dynamic_pointer_cast&lt;Kernel::Units::Label&gt;(UnitFactory::Instance().<a class="code hl_function" href="../../db/d22/namespaceMantid_1_1DataObjects.html#ada9e481cb775152f9a3a3bef1df129ec">create</a>(<span class="stringliteral">&quot;Label&quot;</span>));</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    unitLbl-&gt;setLabel(<span class="stringliteral">&quot;height&quot;</span>, <span class="stringliteral">&quot;cm&quot;</span>);</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    ws-&gt;getAxis(1)-&gt;unit() = unitLbl;</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span> </div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    ws-&gt;setDistribution(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <span class="comment">// TODO: what to do when loading 1pixel - 1 spectrum?</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>  }</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  ws-&gt;setYUnitLabel(<span class="stringliteral">&quot;brightness&quot;</span>);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  <span class="comment">// Add all header info to log.</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;headerKey : fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>) {</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    ws-&gt;mutableRun().removeLogData(headerKey.first, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    ws-&gt;mutableRun().addLogData(<span class="keyword">new</span> <a class="code hl_class" href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">PropertyWithValue&lt;std::string&gt;</a>(headerKey.first, headerKey.second));</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>  <span class="comment">// Add rotational data to log. Clear first from copied WS</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>  <span class="keyword">auto</span> it = fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>.find(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abed2d233130bd360cb205c1686985441">m_sampleRotation</a>);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>  ws-&gt;mutableRun().removeLogData(<span class="stringliteral">&quot;Rotation&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>.end() != it) {</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="keyword">auto</span> rot = boost::lexical_cast&lt;double&gt;(it-&gt;second);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    <span class="keywordflow">if</span> (rot &gt;= 0) {</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>      ws-&gt;mutableRun().addLogData(<span class="keyword">new</span> <a class="code hl_class" href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">PropertyWithValue&lt;double&gt;</a>(<span class="stringliteral">&quot;Rotation&quot;</span>, rot));</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>    }</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  }</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span> </div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <span class="comment">// Add axis information to log. Clear first from copied WS</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>  ws-&gt;mutableRun().removeLogData(<span class="stringliteral">&quot;Axis1&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>  ws-&gt;mutableRun().addLogData(<span class="keyword">new</span> <a class="code hl_class" href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">PropertyWithValue&lt;int&gt;</a>(<span class="stringliteral">&quot;Axis1&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0])));</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>  ws-&gt;mutableRun().removeLogData(<span class="stringliteral">&quot;Axis2&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  ws-&gt;mutableRun().addLogData(<span class="keyword">new</span> <a class="code hl_class" href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">PropertyWithValue&lt;int&gt;</a>(<span class="stringliteral">&quot;Axis2&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1])));</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <span class="comment">// Add image key data to log. Clear first from copied WS</span></div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  ws-&gt;mutableRun().removeLogData(<span class="stringliteral">&quot;ImageKey&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  ws-&gt;mutableRun().addLogData(<span class="keyword">new</span> <a class="code hl_class" href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">PropertyWithValue&lt;std::string&gt;</a>(<span class="stringliteral">&quot;ImageKey&quot;</span>, fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3e2d5a8687ddfcb0f8333dd7b7e3fcc7">imageKey</a>));</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>}</div>
</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="foldopen" id="foldopen00751" data-start="{" data-end="}">
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a705d2ad118524641091dd71d5baad62c">  751</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a705d2ad118524641091dd71d5baad62c">LoadFITS::readDataToWorkspace</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;fileInfo, <span class="keywordtype">double</span> cmpp, <span class="keyword">const</span> <a class="code hl_typedef" href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Workspace2D_sptr</a> &amp;ws,</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>                                   std::vector&lt;char&gt; &amp;buffer) {</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> bytespp = (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> / 8);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> len = <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">m_pixelCount</a> * bytespp;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a9e6a5aa26c8ad53953c63f6f4086a2b6">readInBuffer</a>(fileInfo, buffer, len);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code hl_variable" href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a08a46964797c102d8bcb0ebf53dacc37">nrows</a>(fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1]), <a class="code hl_variable" href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a6a9e83f0fe17b30e07c3a763d298e348">ncols</a>(fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0]);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>  <span class="comment">// Treat buffer as a series of bytes</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="keyword">auto</span> *buffer8 = <span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(buffer.data());</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>  <a class="code hl_define" href="../../da/d1c/MultiThreaded_8h.html#a37846a2caae947255aebfeb369270e33">PARALLEL_FOR_NO_WSP_CHECK</a>()</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; static_cast&lt;int&gt;(<a class="code hl_variable" href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a08a46964797c102d8bcb0ebf53dacc37">nrows</a>); ++i) {</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="keyword">auto</span> &amp;xVals = ws-&gt;mutableX(i);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="keyword">auto</span> &amp;yVals = ws-&gt;mutableY(i);</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <span class="keyword">auto</span> &amp;eVals = ws-&gt;mutableE(i);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    xVals = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(i) * cmpp;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_variable" href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a6a9e83f0fe17b30e07c3a763d298e348">ncols</a>; ++j) {</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>      <span class="comment">// Map from 2D-&gt;1D index</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      <span class="keyword">const</span> <span class="keywordtype">size_t</span> start = ((i * (bytespp)) * <a class="code hl_variable" href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a08a46964797c102d8bcb0ebf53dacc37">nrows</a>) + (j * (bytespp));</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      uint8_t <span class="keyword">const</span> *<span class="keyword">const</span> buffer8Start = buffer8 + start;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>      <span class="comment">// Reverse byte order of current value. Make sure we allocate enough</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>      <span class="comment">// enough space to hold the size</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>      uint8_t byteValue[<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a7d68e8a77ac7f413389a02887de91f46">g_maxBytesPP</a>];</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>      std::reverse_copy(buffer8Start, buffer8Start + bytespp, byteValue);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>      <span class="keywordtype">double</span> val = 0;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 8) {</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        val = toDouble&lt;uint8_t&gt;(byteValue);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 16) {</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        val = toDouble&lt;uint16_t&gt;(byteValue);</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 32 &amp;&amp; !fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>) {</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>        val = toDouble&lt;uint32_t&gt;(byteValue);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 64 &amp;&amp; !fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>) {</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        val = toDouble&lt;uint32_t&gt;(byteValue);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 32 &amp;&amp; fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>) {</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        val = toDouble&lt;float&gt;(byteValue);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 64 &amp;&amp; fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>) {</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        val = toDouble&lt;double&gt;(byteValue);</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>      }</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span> </div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>      val = fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#ac6bd18a273b57a12562a139d570e59ab">scale</a> * val - fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a7fa96ffe4c950f33c4c97e7b214d51c3">offset</a>;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      yVals[j] = val;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      eVals[j] = sqrt(val);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>  }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>}</div>
</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="foldopen" id="foldopen00810" data-start="{" data-end="}">
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8763b2c4bf0e9c637803aaebb570e49a">  810</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8763b2c4bf0e9c637803aaebb570e49a">LoadFITS::readDataToImgs</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;fileInfo, <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageY, <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageE,</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>                              std::vector&lt;char&gt; &amp;buffer) {</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span> </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>  <span class="keywordtype">size_t</span> bytespp = (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> / 8);</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>  <span class="keywordtype">size_t</span> len = <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">m_pixelCount</a> * bytespp;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>  <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a9e6a5aa26c8ad53953c63f6f4086a2b6">readInBuffer</a>(fileInfo, buffer, len);</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>  <span class="comment">// create pointer of correct data type to void pointer of the buffer:</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>  <span class="keyword">auto</span> *buffer8 = <span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(&amp;buffer[0]);</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>  std::vector&lt;char&gt; buf(bytespp);</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a> = buf.data();</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>  <span class="keywordtype">size_t</span> start = 0;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[1]; ++i) {   <span class="comment">// width</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">axisPixelLengths</a>[0]; ++j) { <span class="comment">// height</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>      <span class="comment">// If you wanted to PARALLEL_...ize these loops (which doesn&#39;t</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>      <span class="comment">// seem to provide any speed up when loading images one at a</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>      <span class="comment">// time, you cannot use the start+=bytespp at the end of this</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>      <span class="comment">// loop. You&#39;d need something like this:</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>      <span class="comment">//</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>      <span class="comment">// size_t start =</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>      <span class="comment">// ((i * (bytespp)) * fileInfo.axisPixelLengths[1]) +</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>      <span class="comment">// (j * (bytespp));</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>      <span class="comment">// Reverse byte order of current value</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>      std::reverse_copy(buffer8 + start, buffer8 + start + bytespp, <a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>);</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>      <span class="keywordtype">double</span> val = 0;</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 8)</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(*<span class="keyword">reinterpret_cast&lt;</span>uint8_t *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>));</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 16)</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(*<span class="keyword">reinterpret_cast&lt;</span>uint16_t *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>));</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 32 &amp;&amp; !fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>)</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(*<span class="keyword">reinterpret_cast&lt;</span>uint32_t *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>));</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 64 &amp;&amp; !fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>)</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>        val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(*<span class="keyword">reinterpret_cast&lt;</span>uint64_t *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>));</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>      <span class="comment">// cppcheck doesn&#39;t realise that these are safe casts</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 32 &amp;&amp; fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>) {</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        <span class="comment">// cppcheck-suppress invalidPointerCast</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>        val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(*<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span> *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>));</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>      }</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>      <span class="keywordflow">if</span> (fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">bitsPerPixel</a> == 64 &amp;&amp; fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">isFloat</a>) {</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>        <span class="comment">// cppcheck-suppress invalidPointerCast</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>        val = *<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a>);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>      }</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>      val = fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#ac6bd18a273b57a12562a139d570e59ab">scale</a> * val - fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a7fa96ffe4c950f33c4c97e7b214d51c3">offset</a>;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>      imageY[i][j] = val;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>      imageE[i][j] = sqrt(val);</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>      start += bytespp;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    }</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>  }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>}</div>
</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span> </div>
<div class="foldopen" id="foldopen00872" data-start="{" data-end="}">
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a9e6a5aa26c8ad53953c63f6f4086a2b6">  872</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a9e6a5aa26c8ad53953c63f6f4086a2b6">LoadFITS::readInBuffer</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;fileInfo, std::vector&lt;char&gt; &amp;buffer, <span class="keywordtype">size_t</span> len) {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>  std::string filename = fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">filePath</a>;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>  std::ifstream file(filename, std::ios::in | std::ios::binary);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>  file.seekg(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a1d219adcd9453db7b2f2d93f37fb6568">g_BASE_HEADER_SIZE</a> * fileInfo.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">headerSizeMultiplier</a>);</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>  file.read(&amp;buffer[0], len);</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>  <span class="keywordflow">if</span> (!file) {</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error while reading file: &quot;</span> + filename + <span class="stringliteral">&quot;. Tried to read &quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(len) +</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>                             <span class="stringliteral">&quot; bytes but got &quot;</span> + <a class="code hl_function" href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a>(file.gcount()) +</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                             <span class="stringliteral">&quot; bytes. The file and/or its headers may be wrong.&quot;</span>);</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>  }</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>  <span class="comment">// all is loaded</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>  file.close();</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>}</div>
</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span> </div>
<div class="foldopen" id="foldopen00895" data-start="{" data-end="}">
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2fc57c4c89288b8f19de5e64cb7645b9">  895</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2fc57c4c89288b8f19de5e64cb7645b9">LoadFITS::doFilterNoise</a>(<span class="keywordtype">double</span> thresh, <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageY, <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageE) {</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>  <span class="keywordflow">if</span> (thresh &lt;= 0.0)</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>  <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> goodY = imageY;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>  <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> goodE = imageE;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>  <span class="comment">// TODO: this is not very smart about the edge pixels (leftmost and</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>  <span class="comment">// rightmost columns, topmost and bottom rows)</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 1; j &lt; (imageY.size() - 1); ++j) {</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; (imageY[0].size() - 1); ++i) {</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>      <span class="keywordflow">if</span> (((imageY[j][i] - imageY[j][i - 1]) &gt; thresh) &amp;&amp; ((imageY[j][i] - imageY[j][i + 1]) &gt; thresh) &amp;&amp;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>          ((imageY[j][i] - imageY[j - 1][i]) &gt; thresh) &amp;&amp; ((imageY[j][i] - imageY[j + 1][i]) &gt; thresh))</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>        goodY[j][i] = 0;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        goodY[j][i] = 1;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>      <span class="keywordflow">if</span> (((imageE[j][i] - imageE[j][i - 1]) &gt; thresh) &amp;&amp; ((imageE[j][i] - imageE[j][i + 1]) &gt; thresh) &amp;&amp;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>          ((imageE[j][i] - imageE[j - 1][i]) &gt; thresh) &amp;&amp; ((imageE[j][i] - imageE[j + 1][i]) &gt; thresh))</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        goodE[j][i] = 0;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        goodE[j][i] = 1;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>    }</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>  }</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 1; j &lt; (imageY.size() - 1); ++j) {</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; (imageY[0].size() - 1); ++i) {</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>      <span class="keywordflow">if</span> (goodY[j][i] == 0.0) {</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>        <span class="keywordflow">if</span> (goodY[j - 1][i] != 0.0 || goodY[j + 1][i] != 0.0 || goodY[j][i - 1] != 0.0 || goodY[j][i + 1] != 0.0) {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>          imageY[j][i] = goodY[j - 1][i] * imageY[j - 1][i] + goodY[j + 1][i] * imageY[j + 1][i] +</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                         goodY[j][i - 1] * imageY[j][i - 1] + goodY[j][i + 1] * imageY[j][i + 1];</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>        }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>      }</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>      <span class="keywordflow">if</span> (goodE[j][i] == 0.0) {</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>        <span class="keywordflow">if</span> (goodE[j - 1][i] != 0.0 || goodE[j + 1][i] != 0.0 || goodE[j][i - 1] != 0.0 || goodE[j][i + 1] != 0.0) {</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>          imageE[j][i] = goodE[j - 1][i] * imageE[j - 1][i] + goodE[j + 1][i] * imageE[j + 1][i] +</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>                         goodE[j][i - 1] * imageE[j][i - 1] + goodE[j][i + 1] * imageE[j][i + 1];</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>        }</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>      }</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>    }</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>  }</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>}</div>
</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="foldopen" id="foldopen00949" data-start="{" data-end="}">
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a938a242c59e2ddd966c8adcf127ce16f">  949</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a938a242c59e2ddd966c8adcf127ce16f">LoadFITS::doRebin</a>(<span class="keywordtype">size_t</span> rebin, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageY, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;imageE, <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;rebinnedY,</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>                       <a class="code hl_typedef" href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">MantidImage</a> &amp;rebinnedE) {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>  <span class="keywordflow">if</span> (1 &gt;= rebin)</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span> </div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; (rebinnedY.size() - rebin + 1); ++j) {</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; (rebinnedY[0].size() - rebin + 1); ++i) {</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>      <span class="keywordtype">double</span> accumY = 0.0;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>      <span class="keywordtype">double</span> accumE = 0.0;</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>      <span class="keywordtype">size_t</span> origJ = j * rebin;</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      <span class="keywordtype">size_t</span> origI = i * rebin;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; rebin; ++k) {</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; rebin; ++l) {</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>          accumY += imageY[origJ + k][origI + l];</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>          accumE += imageE[origJ + k][origI + l];</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        }</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>      }</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>      rebinnedY[j][i] = accumY;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>      rebinnedE[j][i] = accumE;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    }</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>  }</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>}</div>
</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span> </div>
<div class="foldopen" id="foldopen00983" data-start="{" data-end="}">
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ae993fb404f1da11141a06b6b673a09a4">  983</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ae993fb404f1da11141a06b6b673a09a4">LoadFITS::isInstrOtherThanIMAT</a>(<span class="keyword">const</span> <a class="code hl_struct" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">FITSInfo</a> &amp;hdr) {</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>  <span class="keywordtype">bool</span> res = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>  <span class="comment">// Images taken with Starlight camera contain this header entry:</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>  <span class="comment">// INSTRUME=&#39;Starlight Xpress CCD&#39;</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>  <span class="keyword">auto</span> it = hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>.find(<span class="stringliteral">&quot;INSTRUME&quot;</span>);</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>  <span class="keywordflow">if</span> (hdr.<a class="code hl_variable" href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">headerKeys</a>.end() != it &amp;&amp; boost::contains(it-&gt;second, <span class="stringliteral">&quot;Starlight&quot;</span>)) {</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    <span class="comment">// For now, do nothing, just tell</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <span class="comment">// Cameras used for HiFi and EMU are in principle only used</span></div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    <span class="comment">// occasionally for calibration</span></div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#ad1469533f03502f2d0f14cf3456f4ef3">information</a>() &lt;&lt; <span class="stringliteral">&quot;Found this in the file headers: &quot;</span> &lt;&lt; it-&gt;first &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; it-&gt;second</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>                        &lt;&lt; <span class="stringliteral">&quot;. This file seems to come from a Starlight camera, &quot;</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>                           <span class="stringliteral">&quot;as used for calibration of the instruments HiFi and EMU (and&quot;</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>                           <span class="stringliteral">&quot;possibly others). Note: not &quot;</span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>                           <span class="stringliteral">&quot;loading instrument definition.\n&quot;</span>;</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>  }</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span> </div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>}</div>
</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span> </div>
<div class="foldopen" id="foldopen01008" data-start="{" data-end="}">
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8fd3cc92403065554df201b44e682df6"> 1008</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8fd3cc92403065554df201b44e682df6">LoadFITS::setupDefaultKeywordNames</a>() {</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>  <span class="comment">// Inits all the absolutely necessary keywords</span></div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>  <span class="comment">// standard headers (If SIMPLE=T)</span></div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aac45e4e3aafa778b827ee4638ca6c109">m_headerScaleKey</a> = <span class="stringliteral">&quot;BSCALE&quot;</span>;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">m_headerOffsetKey</a> = <span class="stringliteral">&quot;BZERO&quot;</span>;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">m_headerBitDepthKey</a> = <span class="stringliteral">&quot;BITPIX&quot;</span>;</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5a1ffe72c47d76e942be1ba235f2586d">m_headerImageKeyKey</a> = <span class="stringliteral">&quot;IMAGE_TYPE&quot;</span>; <span class="comment">// This is a &quot;HIERARCH Image/Type= &quot;</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a01ec003ac5e3101ed191793d99ee5340">m_headerRotationKey</a> = <span class="stringliteral">&quot;ROTATION&quot;</span>;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span> </div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a233be3a2ea4a8527af6abd6a42e9a564">m_headerNAxisNameKey</a> = <span class="stringliteral">&quot;NAXIS&quot;</span>;</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>.emplace_back(<span class="stringliteral">&quot;NAXIS1&quot;</span>);</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>.emplace_back(<span class="stringliteral">&quot;NAXIS2&quot;</span>);</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa74af841f0c6d28b9cb667712c6fdd2f">m_mapFile</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span> </div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>  <span class="comment">// extensions</span></div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abed2d233130bd360cb205c1686985441">m_sampleRotation</a> = <span class="stringliteral">&quot;HIERARCH Sample/Tomo_Angle&quot;</span>;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>  <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0ba43cba06acfe7b492cad9cc722255a">m_imageType</a> = <span class="stringliteral">&quot;HIERARCH Image/Type&quot;</span>;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>}</div>
</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="foldopen" id="foldopen01031" data-start="{" data-end="}">
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abf500c01f62758fc5806b5109a58b4c7"> 1031</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abf500c01f62758fc5806b5109a58b4c7">LoadFITS::mapHeaderKeys</a>() {</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a3f42e205cfdb677cc2b4033e4f2ef3da">getPropertyValue</a>(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa43e1c04da1589005b0ba053ae1d293b">g_HEADER_MAP_NAME</a>).empty())</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span> </div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>  <span class="comment">// If a map file is selected, use that.</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>  std::string headerMapFileName = <a class="code hl_function" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a3f42e205cfdb677cc2b4033e4f2ef3da">getPropertyValue</a>(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa43e1c04da1589005b0ba053ae1d293b">g_HEADER_MAP_NAME</a>);</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>  std::ifstream fStream(headerMapFileName.c_str());</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span> </div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    <span class="comment">// Ensure valid file</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    <span class="keywordflow">if</span> (fStream.good()) {</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>      <span class="comment">// Get lines, split words, verify and add to map.</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>      std::string line;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>      std::vector&lt;std::string&gt; lineSplit;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>      <span class="keywordflow">while</span> (getline(fStream, line)) {</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        boost::split(lineSplit, line, boost::is_any_of(<span class="stringliteral">&quot;=&quot;</span>));</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span> </div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>        <span class="keywordflow">if</span> (lineSplit[0] == <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aca65fc9ea2551904a45be67580fca740">g_ROTATION_NAME</a> &amp;&amp; !lineSplit[1].empty())</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>          <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a01ec003ac5e3101ed191793d99ee5340">m_headerRotationKey</a> = lineSplit[1];</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <span class="keywordflow">if</span> (lineSplit[0] == <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a834acfba79a01028130d8958cff94121">g_BIT_DEPTH_NAME</a> &amp;&amp; !lineSplit[1].empty())</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>          <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">m_headerBitDepthKey</a> = lineSplit[1];</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span> </div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>        <span class="keywordflow">if</span> (lineSplit[0] == <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0d20b9525b555aa76e2bf8b019e68de8">g_AXIS_NAMES_NAME</a> &amp;&amp; !lineSplit[1].empty()) {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>          <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>.clear();</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>          boost::split(<a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">m_headerAxisNameKeys</a>, lineSplit[1], boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>        }</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span> </div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>        <span class="keywordflow">if</span> (lineSplit[0] == <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac9e914beb9890f15a4280206f308d282">g_IMAGE_KEY_NAME</a> &amp;&amp; !lineSplit[1].empty()) {</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>          <a class="code hl_variable" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5a1ffe72c47d76e942be1ba235f2586d">m_headerImageKeyKey</a> = lineSplit[1];</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>        }</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>      }</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span> </div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>      fStream.close();</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error while trying to read header keys mapping file: &quot;</span> + headerMapFileName);</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>    <a class="code hl_variable" href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">g_log</a>.<a class="code hl_function" href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a56bbdfffa5a708ee5b613a82f1f0ab1a">error</a>(<span class="stringliteral">&quot;Cannot load specified map file, using property values &quot;</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>                <span class="stringliteral">&quot;and/or defaults.&quot;</span>);</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>  }</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>}</div>
</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span> </div>
<div class="foldopen" id="foldopen01083" data-start="{" data-end="}">
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abcbe7b476dc62231d08ed6de18014e3a"> 1083</a></span><span class="keywordtype">size_t</span> <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abcbe7b476dc62231d08ed6de18014e3a">LoadFITS::fetchNumber</a>(<span class="keyword">const</span> std::string &amp;<a class="code hl_variable" href="../../d7/d7c/API_2src_2Run_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) {</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>  std::string tmpStr;</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a355cf8c369886e453b5781a06beac130">name</a>.end() - 1; isdigit(*it); --it) {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    tmpStr.insert(0, 1, *it);</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>  }</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>  <span class="keywordflow">while</span> (tmpStr.length() &gt; 0 &amp;&amp; tmpStr[0] == <span class="charliteral">&#39;0&#39;</span>) {</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>    tmpStr.erase(tmpStr.begin());</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>  }</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>  <span class="keywordflow">return</span> (tmpStr.length() &gt; 0) ? boost::lexical_cast&lt;size_t&gt;(tmpStr) : 0;</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>}</div>
</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span> </div>
<div class="foldopen" id="foldopen01105" data-start="{" data-end="}">
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"><a class="line" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a17415dc3537b724fad046a3d03d91030"> 1105</a></span>std::string <a class="code hl_function" href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a17415dc3537b724fad046a3d03d91030">LoadFITS::padZeros</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> number, <span class="keyword">const</span> <span class="keywordtype">size_t</span> totalDigitCount) {</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>  std::ostringstream ss;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>  ss &lt;&lt; std::setw(static_cast&lt;int&gt;(totalDigitCount)) &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(number);</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>  <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>}</div>
</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>} <span class="comment">// namespace Mantid::DataHandling</span></div>
<div class="ttc" id="aAPI_2src_2Run_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="../../d7/d7c/API_2src_2Run_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d7c/API_2src_2Run_8cpp_source.html#l00060">Run.cpp:60</a></div></div>
<div class="ttc" id="aAugmentedLagrangianOptimizer_8cpp_html_a660359cf4ac080f70be4b1dd129eb766"><div class="ttname"><a href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp.html#a660359cf4ac080f70be4b1dd129eb766">tmp</a></div><div class="ttdeci">gsl_vector * tmp</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df2/AugmentedLagrangianOptimizer_8cpp_source.html#l00049">AugmentedLagrangianOptimizer.cpp:49</a></div></div>
<div class="ttc" id="aBoundedValidator_8h_html"><div class="ttname"><a href="../../dd/d4d/BoundedValidator_8h.html">BoundedValidator.h</a></div></div>
<div class="ttc" id="aComptonScatteringCountRate_8cpp_html_a08a46964797c102d8bcb0ebf53dacc37"><div class="ttname"><a href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a08a46964797c102d8bcb0ebf53dacc37">nrows</a></div><div class="ttdeci">size_t nrows</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d18/ComptonScatteringCountRate_8cpp_source.html#l00096">ComptonScatteringCountRate.cpp:96</a></div></div>
<div class="ttc" id="aComptonScatteringCountRate_8cpp_html_a6a9e83f0fe17b30e07c3a763d298e348"><div class="ttname"><a href="../../d0/d18/ComptonScatteringCountRate_8cpp.html#a6a9e83f0fe17b30e07c3a763d298e348">ncols</a></div><div class="ttdeci">size_t ncols</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d18/ComptonScatteringCountRate_8cpp_source.html#l00097">ComptonScatteringCountRate.cpp:97</a></div></div>
<div class="ttc" id="aFileProperty_8h_html"><div class="ttname"><a href="../../d1/d17/FileProperty_8h.html">FileProperty.h</a></div></div>
<div class="ttc" id="aFitMW_8cpp_html_aee90379adb0307effb138f4871edbc5c"><div class="ttname"><a href="../../d5/d0b/FitMW_8cpp.html#aee90379adb0307effb138f4871edbc5c">value</a></div><div class="ttdeci">double value</div><div class="ttdoc">The value of the point.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d0b/FitMW_8cpp_source.html#l00051">FitMW.cpp:51</a></div></div>
<div class="ttc" id="aGetAllEi_8cpp_html_a89f6abd564014faeff7cd20c340a9c7d"><div class="ttname"><a href="../../d6/d64/GetAllEi_8cpp.html#a89f6abd564014faeff7cd20c340a9c7d">height</a></div><div class="ttdeci">double height</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d64/GetAllEi_8cpp_source.html#l00155">GetAllEi.cpp:155</a></div></div>
<div class="ttc" id="aLoadFITS_8h_html"><div class="ttname"><a href="../../da/d30/LoadFITS_8h.html">LoadFITS.h</a></div></div>
<div class="ttc" id="aMultiThreaded_8h_html_a37846a2caae947255aebfeb369270e33"><div class="ttname"><a href="../../da/d1c/MultiThreaded_8h.html#a37846a2caae947255aebfeb369270e33">PARALLEL_FOR_NO_WSP_CHECK</a></div><div class="ttdeci">#define PARALLEL_FOR_NO_WSP_CHECK()</div><div class="ttdef"><b>Definition</b> <a href="../../da/d1c/MultiThreaded_8h_source.html#l00219">MultiThreaded.h:219</a></div></div>
<div class="ttc" id="aMultipleFileProperty_8h_html"><div class="ttname"><a href="../../d0/d8f/MultipleFileProperty_8h.html">MultipleFileProperty.h</a></div></div>
<div class="ttc" id="aNumericAxis_8h_html"><div class="ttname"><a href="../../d9/ddd/NumericAxis_8h.html">NumericAxis.h</a></div></div>
<div class="ttc" id="aRegisterFileLoader_8h_html"><div class="ttname"><a href="../../d5/db4/RegisterFileLoader_8h.html">RegisterFileLoader.h</a></div></div>
<div class="ttc" id="aRegisterFileLoader_8h_html_a2f226eb8da0d4adb411ba1400602ff86"><div class="ttname"><a href="../../d5/db4/RegisterFileLoader_8h.html#a2f226eb8da0d4adb411ba1400602ff86">DECLARE_FILELOADER_ALGORITHM</a></div><div class="ttdeci">#define DECLARE_FILELOADER_ALGORITHM(classname)</div><div class="ttdoc">DECLARE_FILELOADER_ALGORITHM should be used in place of the standard DECLARE_ALGORITHM macro when wri...</div><div class="ttdef"><b>Definition</b> <a href="../../d5/db4/RegisterFileLoader_8h_source.html#l00019">RegisterFileLoader.h:19</a></div></div>
<div class="ttc" id="aRun_8h_html"><div class="ttname"><a href="../../dd/d49/Run_8h.html">Run.h</a></div></div>
<div class="ttc" id="aUnitFactory_8h_html"><div class="ttname"><a href="../../d3/dfd/UnitFactory_8h.html">UnitFactory.h</a></div></div>
<div class="ttc" id="aUnit_8h_html"><div class="ttname"><a href="../../d1/daf/Unit_8h.html">Unit.h</a></div></div>
<div class="ttc" id="aWorkspace2D_8h_html"><div class="ttname"><a href="../../d2/d95/Workspace2D_8h.html">Workspace2D.h</a></div></div>
<div class="ttc" id="aWorkspaceFactory_8h_html"><div class="ttname"><a href="../../db/d7b/WorkspaceFactory_8h.html">WorkspaceFactory.h</a></div></div>
<div class="ttc" id="aWorkspaceGroup_8h_html"><div class="ttname"><a href="../../d9/db3/WorkspaceGroup_8h.html">WorkspaceGroup.h</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Algorithm_html_a0e4d44cd6beedd532b852996c3f193f2"><div class="ttname"><a href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a0e4d44cd6beedd532b852996c3f193f2">Mantid::API::Algorithm::declareProperty</a></div><div class="ttdeci">void declareProperty(std::unique_ptr&lt; Kernel::Property &gt; p, const std::string &amp;doc=&quot;&quot;) override</div><div class="ttdoc">Add a property to the list of managed properties.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc1/API_2src_2Algorithm_8cpp_source.html#l01803">Algorithm.cpp:1803</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Algorithm_html_a3f42e205cfdb677cc2b4033e4f2ef3da"><div class="ttname"><a href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a3f42e205cfdb677cc2b4033e4f2ef3da">Mantid::API::Algorithm::getPropertyValue</a></div><div class="ttdeci">std::string getPropertyValue(const std::string &amp;name) const override</div><div class="ttdoc">Get the value of a property as a string.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc1/API_2src_2Algorithm_8cpp_source.html#l01916">Algorithm.cpp:1916</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Algorithm_html_a5356ea547c4381e4144caa2b37599ead"><div class="ttname"><a href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a5356ea547c4381e4144caa2b37599ead">Mantid::API::Algorithm::getProperty</a></div><div class="ttdeci">TypedValue getProperty(const std::string &amp;name) const override</div><div class="ttdoc">Get the value of a property.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc1/API_2src_2Algorithm_8cpp_source.html#l01966">Algorithm.cpp:1966</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Algorithm_html_a601ae146d6e558587e743cfad107e6bd"><div class="ttname"><a href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a601ae146d6e558587e743cfad107e6bd">Mantid::API::Algorithm::createChildAlgorithm</a></div><div class="ttdeci">virtual std::shared_ptr&lt; Algorithm &gt; createChildAlgorithm(const std::string &amp;name, const double startProgress=-1., const double endProgress=-1., const bool enableLogging=true, const int &amp;version=-1)</div><div class="ttdoc">Create a Child Algorithm.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc1/API_2src_2Algorithm_8cpp_source.html#l00860">Algorithm.cpp:860</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Algorithm_html_a706ab5e821c27b1f2e221f89d766b809"><div class="ttname"><a href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a706ab5e821c27b1f2e221f89d766b809">Mantid::API::Algorithm::g_log</a></div><div class="ttdeci">Kernel::Logger &amp; g_log</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d36/Algorithm_8h_source.html#l00422">Algorithm.h:422</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Algorithm_html_a7ac471ebfae5ff09e8423fba191f09fd"><div class="ttname"><a href="../../d3/d69/classMantid_1_1API_1_1Algorithm.html#a7ac471ebfae5ff09e8423fba191f09fd">Mantid::API::Algorithm::progress</a></div><div class="ttdeci">void progress(double p, const std::string &amp;msg=&quot;&quot;, double estimatedTime=0.0, int progressPrecision=0)</div><div class="ttdoc">Sends ProgressNotification.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc1/API_2src_2Algorithm_8cpp_source.html#l00240">Algorithm.cpp:240</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1FileProperty_html_afea15d5ce8f5a4d64f12e0e3b85f5d12acdd20a88b77c992ea30de80c7e7698f5"><div class="ttname"><a href="../../d8/d3b/classMantid_1_1API_1_1FileProperty.html#afea15d5ce8f5a4d64f12e0e3b85f5d12acdd20a88b77c992ea30de80c7e7698f5">Mantid::API::FileProperty::OptionalDirectory</a></div><div class="ttdeci">@ OptionalDirectory</div><div class="ttdoc">to specify a directory that does not have to exist</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d17/FileProperty_8h_source.html#l00056">FileProperty.h:55</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1Progress_html"><div class="ttname"><a href="../../de/dd6/classMantid_1_1API_1_1Progress.html">Mantid::API::Progress</a></div><div class="ttdoc">Helper class for reporting progress from algorithms.</div><div class="ttdef"><b>Definition</b> <a href="../../de/df3/Progress_8h_source.html#l00025">Progress.h:25</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1WorkspaceGroup_html"><div class="ttname"><a href="../../d9/de9/classMantid_1_1API_1_1WorkspaceGroup.html">Mantid::API::WorkspaceGroup</a></div><div class="ttdoc">Class to hold a set of workspaces.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/db3/WorkspaceGroup_8h_source.html#l00037">WorkspaceGroup.h:37</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1WorkspaceGroup_html_ab8e78d1f1e48cff0320783cacf44ad83"><div class="ttname"><a href="../../d9/de9/classMantid_1_1API_1_1WorkspaceGroup.html#ab8e78d1f1e48cff0320783cacf44ad83">Mantid::API::WorkspaceGroup::getNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getNames() const</div><div class="ttdoc">Returns the names of workspaces that make up this group.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d7b/API_2src_2WorkspaceGroup_8cpp_source.html#l00201">WorkspaceGroup.cpp:201</a></div></div>
<div class="ttc" id="aclassMantid_1_1API_1_1WorkspaceProperty_html"><div class="ttname"><a href="../../df/d44/classMantid_1_1API_1_1WorkspaceProperty.html">Mantid::API::WorkspaceProperty</a></div><div class="ttdoc">A property class for workspaces.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/db9/WorkspaceProperty_8h_source.html#l00051">WorkspaceProperty.h:51</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html">Mantid::DataHandling::LoadFITS</a></div><div class="ttdoc">LoadFITS: Load one or more of FITS files into a Workspace2D.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00036">LoadFITS.h:36</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a01ec003ac5e3101ed191793d99ee5340"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a01ec003ac5e3101ed191793d99ee5340">Mantid::DataHandling::LoadFITS::m_headerRotationKey</a></div><div class="ttdeci">std::string m_headerRotationKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00125">LoadFITS.h:125</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a03269fb8eed38c7dc2090d19c25db866"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a03269fb8eed38c7dc2090d19c25db866">Mantid::DataHandling::LoadFITS::g_maxBitDepth</a></div><div class="ttdeci">static const size_t g_maxBitDepth</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00162">LoadFITS.h:162</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a09ba9cee53cbb0b0fd2751e66435f671"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a09ba9cee53cbb0b0fd2751e66435f671">Mantid::DataHandling::LoadFITS::exec</a></div><div class="ttdeci">void exec() override</div><div class="ttdoc">Execution code.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00150">LoadFITS.cpp:150</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a0b756aefae818c06f8af0ebb44f78f2b"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0b756aefae818c06f8af0ebb44f78f2b">Mantid::DataHandling::LoadFITS::m_headerBitDepthKey</a></div><div class="ttdeci">std::string m_headerBitDepthKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00124">LoadFITS.h:124</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a0ba43cba06acfe7b492cad9cc722255a"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0ba43cba06acfe7b492cad9cc722255a">Mantid::DataHandling::LoadFITS::m_imageType</a></div><div class="ttdeci">std::string m_imageType</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00135">LoadFITS.h:135</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a0d20b9525b555aa76e2bf8b019e68de8"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a0d20b9525b555aa76e2bf8b019e68de8">Mantid::DataHandling::LoadFITS::g_AXIS_NAMES_NAME</a></div><div class="ttdeci">static const std::string g_AXIS_NAMES_NAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00155">LoadFITS.h:155</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a17415dc3537b724fad046a3d03d91030"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a17415dc3537b724fad046a3d03d91030">Mantid::DataHandling::LoadFITS::padZeros</a></div><div class="ttdeci">std::string padZeros(const size_t number, const size_t totalDigitCount)</div><div class="ttdoc">Adds 0's to the front of a number to create a string of size totalDigitCount including number.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l01105">LoadFITS.cpp:1105</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a1d219adcd9453db7b2f2d93f37fb6568"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a1d219adcd9453db7b2f2d93f37fb6568">Mantid::DataHandling::LoadFITS::g_BASE_HEADER_SIZE</a></div><div class="ttdeci">static const int g_BASE_HEADER_SIZE</div><div class="ttdoc">size of a FITS header block (room for 36 entries, of 80 characters each), in bytes.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00145">LoadFITS.h:145</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a233be3a2ea4a8527af6abd6a42e9a564"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a233be3a2ea4a8527af6abd6a42e9a564">Mantid::DataHandling::LoadFITS::m_headerNAxisNameKey</a></div><div class="ttdeci">std::string m_headerNAxisNameKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00127">LoadFITS.h:127</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a25af10d16b69342b849bd65a97cdfab5"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a25af10d16b69342b849bd65a97cdfab5">Mantid::DataHandling::LoadFITS::doLoadFiles</a></div><div class="ttdeci">void doLoadFiles(const std::vector&lt; std::string &gt; &amp;paths, const std::string &amp;outWSName, bool loadAsRectImg, int binSize, double noiseThresh)</div><div class="ttdoc">Loads files into workspace(s)</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00369">LoadFITS.cpp:369</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a2ccf68320351055110daf7934708310e"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2ccf68320351055110daf7934708310e">Mantid::DataHandling::LoadFITS::confidence</a></div><div class="ttdeci">int confidence(Kernel::FileDescriptor &amp;descriptor) const override</div><div class="ttdoc">Returns a confidence value that this algorithm can load a file.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00092">LoadFITS.cpp:92</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a2fc57c4c89288b8f19de5e64cb7645b9"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a2fc57c4c89288b8f19de5e64cb7645b9">Mantid::DataHandling::LoadFITS::doFilterNoise</a></div><div class="ttdeci">void doFilterNoise(double thresh, API::MantidImage &amp;imageY, API::MantidImage &amp;imageE)</div><div class="ttdoc">filter noise pixel by pixel</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00895">LoadFITS.cpp:895</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a355cf8c369886e453b5781a06beac130"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a355cf8c369886e453b5781a06beac130">Mantid::DataHandling::LoadFITS::name</a></div><div class="ttdeci">const std::string name() const override</div><div class="ttdoc">Algorithm's name for identification overriding a virtual method.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00041">LoadFITS.h:41</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a46009a238b9abc40485bb54aa9b0bf64"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a46009a238b9abc40485bb54aa9b0bf64">Mantid::DataHandling::LoadFITS::init</a></div><div class="ttdeci">void init() override</div><div class="ttdoc">Initialisation code.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00102">LoadFITS.cpp:102</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a4cbaad041c42e34ee638bc3306b96753"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a4cbaad041c42e34ee638bc3306b96753">Mantid::DataHandling::LoadFITS::g_XTENSION_KEYNAME</a></div><div class="ttdeci">static const std::string g_XTENSION_KEYNAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00153">LoadFITS.h:153</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a54e04660d7e858ed7b0b01b22b1ddf74"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a54e04660d7e858ed7b0b01b22b1ddf74">Mantid::DataHandling::LoadFITS::headerSanityCheck</a></div><div class="ttdeci">void headerSanityCheck(const FITSInfo &amp;hdr, const FITSInfo &amp;hdrFirst)</div><div class="ttdoc">Once loaded, check against standard and limitations of this algorithm.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00310">LoadFITS.cpp:310</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a5977ebd5f9308405dade1436235f58d5"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5977ebd5f9308405dade1436235f58d5">Mantid::DataHandling::LoadFITS::g_COMMENT_KEYNAME</a></div><div class="ttdeci">static const std::string g_COMMENT_KEYNAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00152">LoadFITS.h:152</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a5a1ffe72c47d76e942be1ba235f2586d"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a5a1ffe72c47d76e942be1ba235f2586d">Mantid::DataHandling::LoadFITS::m_headerImageKeyKey</a></div><div class="ttdeci">std::string m_headerImageKeyKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00126">LoadFITS.h:126</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a6c3142b6cc47c3ae5372d9d107a6f5cb"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a6c3142b6cc47c3ae5372d9d107a6f5cb">Mantid::DataHandling::LoadFITS::g_DIGIT_SIZE_APPEND</a></div><div class="ttdeci">static const size_t g_DIGIT_SIZE_APPEND</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00141">LoadFITS.h:141</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a705d2ad118524641091dd71d5baad62c"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a705d2ad118524641091dd71d5baad62c">Mantid::DataHandling::LoadFITS::readDataToWorkspace</a></div><div class="ttdeci">void readDataToWorkspace(const FITSInfo &amp;fileInfo, double cmpp, const DataObjects::Workspace2D_sptr &amp;ws, std::vector&lt; char &gt; &amp;buffer)</div><div class="ttdoc">Reads the data (FITS matrix) from a single FITS file into a workspace (directly into the spectra,...</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00751">LoadFITS.cpp:751</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a7d68e8a77ac7f413389a02887de91f46"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a7d68e8a77ac7f413389a02887de91f46">Mantid::DataHandling::LoadFITS::g_maxBytesPP</a></div><div class="ttdeci">static const size_t g_maxBytesPP</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00164">LoadFITS.h:164</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a80ddc47f261b62d0584a187e174ab0fc"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a80ddc47f261b62d0584a187e174ab0fc">Mantid::DataHandling::LoadFITS::m_headerAxisNameKeys</a></div><div class="ttdeci">std::vector&lt; std::string &gt; m_headerAxisNameKeys</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00128">LoadFITS.h:128</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a834acfba79a01028130d8958cff94121"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a834acfba79a01028130d8958cff94121">Mantid::DataHandling::LoadFITS::g_BIT_DEPTH_NAME</a></div><div class="ttdeci">static const std::string g_BIT_DEPTH_NAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00154">LoadFITS.h:154</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a862c7b7d3df60b1185ecd6b4980b6c08"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a862c7b7d3df60b1185ecd6b4980b6c08">Mantid::DataHandling::LoadFITS::makeWorkspace</a></div><div class="ttdeci">DataObjects::Workspace2D_sptr makeWorkspace(const FITSInfo &amp;fileInfo, size_t &amp;newFileNumber, std::vector&lt; char &gt; &amp;buffer, API::MantidImage &amp;imageY, API::MantidImage &amp;imageE, const DataObjects::Workspace2D_sptr &amp;parent, bool loadAsRectImg=false, int binSize=1, double noiseThresh=false)</div><div class="ttdoc">Initialises a workspace with IDF and fills it with data.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00597">LoadFITS.cpp:597</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a8763b2c4bf0e9c637803aaebb570e49a"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8763b2c4bf0e9c637803aaebb570e49a">Mantid::DataHandling::LoadFITS::readDataToImgs</a></div><div class="ttdeci">void readDataToImgs(const FITSInfo &amp;fileInfo, API::MantidImage &amp;imageY, API::MantidImage &amp;imageE, std::vector&lt; char &gt; &amp;buffer)</div><div class="ttdoc">Reads the data (FITS matrix) from a single FITS file into image objects (Y and E).</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00810">LoadFITS.cpp:810</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a8fd3cc92403065554df201b44e682df6"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a8fd3cc92403065554df201b44e682df6">Mantid::DataHandling::LoadFITS::setupDefaultKeywordNames</a></div><div class="ttdeci">void setupDefaultKeywordNames()</div><div class="ttdoc">Sets several keyword names with default (and standard) values.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l01008">LoadFITS.cpp:1008</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a938a242c59e2ddd966c8adcf127ce16f"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a938a242c59e2ddd966c8adcf127ce16f">Mantid::DataHandling::LoadFITS::doRebin</a></div><div class="ttdeci">void doRebin(size_t rebin, const API::MantidImage &amp;imageY, const API::MantidImage &amp;imageE, API::MantidImage &amp;rebinnedY, API::MantidImage &amp;rebinnedE)</div><div class="ttdoc">rebin the matrix/image</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00949">LoadFITS.cpp:949</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_a9e6a5aa26c8ad53953c63f6f4086a2b6"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#a9e6a5aa26c8ad53953c63f6f4086a2b6">Mantid::DataHandling::LoadFITS::readInBuffer</a></div><div class="ttdeci">void readInBuffer(const FITSInfo &amp;fileInfo, std::vector&lt; char &gt; &amp;buffer, size_t len)</div><div class="ttdoc">Reads the data (FITS matrix) from a single FITS file into a buffer.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00872">LoadFITS.cpp:872</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aa43e1c04da1589005b0ba053ae1d293b"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa43e1c04da1589005b0ba053ae1d293b">Mantid::DataHandling::LoadFITS::g_HEADER_MAP_NAME</a></div><div class="ttdeci">static const std::string g_HEADER_MAP_NAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00158">LoadFITS.h:158</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aa50e837acc8d222168ca3c49ab3724b4"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa50e837acc8d222168ca3c49ab3724b4">Mantid::DataHandling::LoadFITS::parseHeader</a></div><div class="ttdeci">void parseHeader(FITSInfo &amp;headerInfo)</div><div class="ttdoc">Parses the header values for the FITS file.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00498">LoadFITS.cpp:498</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aa74af841f0c6d28b9cb667712c6fdd2f"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aa74af841f0c6d28b9cb667712c6fdd2f">Mantid::DataHandling::LoadFITS::m_mapFile</a></div><div class="ttdeci">std::string m_mapFile</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00129">LoadFITS.h:129</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aab5edec8ba337fcd262c12aad488261c"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aab5edec8ba337fcd262c12aad488261c">Mantid::DataHandling::LoadFITS::g_defaultImgType</a></div><div class="ttdeci">static const std::string g_defaultImgType</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00131">LoadFITS.h:131</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aabe236022548de26f8fdf898b31e9daf"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aabe236022548de26f8fdf898b31e9daf">Mantid::DataHandling::LoadFITS::LoadFITS</a></div><div class="ttdeci">LoadFITS()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00080">LoadFITS.cpp:80</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aac45e4e3aafa778b827ee4638ca6c109"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aac45e4e3aafa778b827ee4638ca6c109">Mantid::DataHandling::LoadFITS::m_headerScaleKey</a></div><div class="ttdeci">std::string m_headerScaleKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00122">LoadFITS.h:122</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ab738f0d0dfd09a0188941d7f970691e4"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ab738f0d0dfd09a0188941d7f970691e4">Mantid::DataHandling::LoadFITS::m_headerOffsetKey</a></div><div class="ttdeci">std::string m_headerOffsetKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00123">LoadFITS.h:123</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_abcbe7b476dc62231d08ed6de18014e3a"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abcbe7b476dc62231d08ed6de18014e3a">Mantid::DataHandling::LoadFITS::fetchNumber</a></div><div class="ttdeci">size_t fetchNumber(const std::string &amp;name)</div><div class="ttdoc">Returns the trailing number from a string minus leading 0's (so 25 from workspace_000025)</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l01083">LoadFITS.cpp:1083</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_abed2d233130bd360cb205c1686985441"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abed2d233130bd360cb205c1686985441">Mantid::DataHandling::LoadFITS::m_sampleRotation</a></div><div class="ttdeci">std::string m_sampleRotation</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00134">LoadFITS.h:134</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_abf500c01f62758fc5806b5109a58b4c7"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#abf500c01f62758fc5806b5109a58b4c7">Mantid::DataHandling::LoadFITS::mapHeaderKeys</a></div><div class="ttdeci">void mapHeaderKeys()</div><div class="ttdoc">Maps the header keys to specified values.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l01031">LoadFITS.cpp:1031</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ac0e54d89a09fcb7d5f04409c4e272623"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac0e54d89a09fcb7d5f04409c4e272623">Mantid::DataHandling::LoadFITS::g_END_KEYNAME</a></div><div class="ttdeci">static const std::string g_END_KEYNAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00151">LoadFITS.h:151</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ac7410832d0df098e62583b9a322a633d"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac7410832d0df098e62583b9a322a633d">Mantid::DataHandling::LoadFITS::loadHeader</a></div><div class="ttdeci">void loadHeader(const std::string &amp;filePath, FITSInfo &amp;header)</div><div class="ttdoc">Load the FITS header(s) from one fits file into a struct.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00166">LoadFITS.cpp:166</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ac814edc871a96575a35353e43c36dc8b"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac814edc871a96575a35353e43c36dc8b">Mantid::DataHandling::LoadFITS::m_pixelCount</a></div><div class="ttdeci">size_t m_pixelCount</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00137">LoadFITS.h:137</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ac9e914beb9890f15a4280206f308d282"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ac9e914beb9890f15a4280206f308d282">Mantid::DataHandling::LoadFITS::g_IMAGE_KEY_NAME</a></div><div class="ttdeci">static const std::string g_IMAGE_KEY_NAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00157">LoadFITS.h:157</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_aca65fc9ea2551904a45be67580fca740"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#aca65fc9ea2551904a45be67580fca740">Mantid::DataHandling::LoadFITS::g_ROTATION_NAME</a></div><div class="ttdeci">static const std::string g_ROTATION_NAME</div><div class="ttdef"><b>Definition</b> <a href="../../da/d30/LoadFITS_8h_source.html#l00156">LoadFITS.h:156</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ace2c2098c976feb8ab0c3c2a7ffb43a0"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ace2c2098c976feb8ab0c3c2a7ffb43a0">Mantid::DataHandling::LoadFITS::addAxesInfoAndLogs</a></div><div class="ttdeci">void addAxesInfoAndLogs(const DataObjects::Workspace2D_sptr &amp;ws, bool loadAsRectImg, const FITSInfo &amp;fileInfo, int binSize, double cmpp)</div><div class="ttdoc">Add information to the workspace being loaded: labels, units, logs related to the image size,...</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00675">LoadFITS.cpp:675</a></div></div>
<div class="ttc" id="aclassMantid_1_1DataHandling_1_1LoadFITS_html_ae993fb404f1da11141a06b6b673a09a4"><div class="ttname"><a href="../../de/dbb/classMantid_1_1DataHandling_1_1LoadFITS.html#ae993fb404f1da11141a06b6b673a09a4">Mantid::DataHandling::LoadFITS::isInstrOtherThanIMAT</a></div><div class="ttdeci">bool isInstrOtherThanIMAT(const FITSInfo &amp;hdr)</div><div class="ttdoc">identifies fits coming from 'other' cameras by specific headers</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00983">LoadFITS.cpp:983</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1FileDescriptor_html"><div class="ttname"><a href="../../dd/dab/classMantid_1_1Kernel_1_1FileDescriptor.html">Mantid::Kernel::FileDescriptor</a></div><div class="ttdoc">Defines a wrapper around an open file.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d8a/FileDescriptor_8h_source.html#l00026">FileDescriptor.h:26</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1FileDescriptor_html_acbe800aef1e22012855937dbc9bb7b44"><div class="ttname"><a href="../../dd/dab/classMantid_1_1Kernel_1_1FileDescriptor.html#acbe800aef1e22012855937dbc9bb7b44">Mantid::Kernel::FileDescriptor::extension</a></div><div class="ttdeci">const std::string &amp; extension() const</div><div class="ttdoc">Access the file extension.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d8a/FileDescriptor_8h_source.html#l00062">FileDescriptor.h:62</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1IPropertyManager_html_a3819af9d65d799ec151ab97c15f147e4"><div class="ttname"><a href="../../d9/dc0/classMantid_1_1Kernel_1_1IPropertyManager.html#a3819af9d65d799ec151ab97c15f147e4">Mantid::Kernel::IPropertyManager::setProperty</a></div><div class="ttdeci">IPropertyManager * setProperty(const std::string &amp;name, const T &amp;value)</div><div class="ttdoc">Templated method to set the value of a PropertyWithValue.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d94/IPropertyManager_8h_source.html#l00270">IPropertyManager.h:270</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1Logger_html_a20b305765f9c40ef2d3004c0d09feb4a"><div class="ttname"><a href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a20b305765f9c40ef2d3004c0d09feb4a">Mantid::Kernel::Logger::debug</a></div><div class="ttdeci">void debug(const std::string &amp;msg)</div><div class="ttdoc">Logs at debug level.</div><div class="ttdef"><b>Definition</b> <a href="../../df/df2/Kernel_2src_2Logger_8cpp_source.html#l00145">Logger.cpp:145</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1Logger_html_a56bbdfffa5a708ee5b613a82f1f0ab1a"><div class="ttname"><a href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a56bbdfffa5a708ee5b613a82f1f0ab1a">Mantid::Kernel::Logger::error</a></div><div class="ttdeci">void error(const std::string &amp;msg)</div><div class="ttdoc">Logs at error level.</div><div class="ttdef"><b>Definition</b> <a href="../../df/df2/Kernel_2src_2Logger_8cpp_source.html#l00108">Logger.cpp:108</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1Logger_html_a6e1ec105dbc2d5ef5430fe6a3a325f8b"><div class="ttname"><a href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#a6e1ec105dbc2d5ef5430fe6a3a325f8b">Mantid::Kernel::Logger::warning</a></div><div class="ttdeci">void warning(const std::string &amp;msg)</div><div class="ttdoc">Logs at warning level.</div><div class="ttdef"><b>Definition</b> <a href="../../df/df2/Kernel_2src_2Logger_8cpp_source.html#l00117">Logger.cpp:117</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1Logger_html_ad1469533f03502f2d0f14cf3456f4ef3"><div class="ttname"><a href="../../d2/d78/classMantid_1_1Kernel_1_1Logger.html#ad1469533f03502f2d0f14cf3456f4ef3">Mantid::Kernel::Logger::information</a></div><div class="ttdeci">void information(const std::string &amp;msg)</div><div class="ttdoc">Logs at information level.</div><div class="ttdef"><b>Definition</b> <a href="../../df/df2/Kernel_2src_2Logger_8cpp_source.html#l00136">Logger.cpp:136</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1PropertyWithValue_html"><div class="ttname"><a href="../../d5/dd1/classMantid_1_1Kernel_1_1PropertyWithValue.html">Mantid::Kernel::PropertyWithValue</a></div><div class="ttdoc">The concrete, templated class for properties.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d2d/PropertyWithValue_8h_source.html#l00032">PropertyWithValue.h:32</a></div></div>
<div class="ttc" id="aclassMantid_1_1Kernel_1_1SingletonHolder_html_af5baabb0203c9b8be209ebd60dc82863"><div class="ttname"><a href="../../d1/d8d/classMantid_1_1Kernel_1_1SingletonHolder.html#af5baabb0203c9b8be209ebd60dc82863">Mantid::Kernel::SingletonHolder::Instance</a></div><div class="ttdeci">static T &amp; Instance()</div><div class="ttdoc">Return a reference to the Singleton instance, creating it if it does not already exist Creation is do...</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/SingletonHolder_8h_source.html#l00091">SingletonHolder.h:91</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1API_html"><div class="ttname"><a href="../../d9/da0/namespaceMantid_1_1API.html">Mantid::API</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc6/AbsorptionCorrection_8h_source.html#l00020">AbsorptionCorrection.h:20</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1API_html_a2177621ba264b5d9d0c8a605e85c0058"><div class="ttname"><a href="../../d9/da0/namespaceMantid_1_1API.html#a2177621ba264b5d9d0c8a605e85c0058">Mantid::API::WorkspaceGroup_sptr</a></div><div class="ttdeci">std::shared_ptr&lt; WorkspaceGroup &gt; WorkspaceGroup_sptr</div><div class="ttdoc">shared pointer to Mantid::API::WorkspaceGroup</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d38/WorkspaceGroup__fwd_8h_source.html#l00020">WorkspaceGroup_fwd.h:20</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1API_html_a54f1bdf963a61928ef4787aa3cbbbdb2"><div class="ttname"><a href="../../d9/da0/namespaceMantid_1_1API.html#a54f1bdf963a61928ef4787aa3cbbbdb2">Mantid::API::MantidImage</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; MantidImage</div><div class="ttdoc">typedef for the image type</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0d/MatrixWorkspace_8h_source.html#l00080">MatrixWorkspace.h:80</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1API_html_af3d93880dabd4c45bfdebcaadd27b2fa"><div class="ttname"><a href="../../d9/da0/namespaceMantid_1_1API.html#af3d93880dabd4c45bfdebcaadd27b2fa">Mantid::API::MatrixWorkspace_sptr</a></div><div class="ttdeci">std::shared_ptr&lt; MatrixWorkspace &gt; MatrixWorkspace_sptr</div><div class="ttdoc">shared pointer to the matrix workspace base class</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0d/MatrixWorkspace_8h_source.html#l00585">MatrixWorkspace.h:585</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1DataHandling_html"><div class="ttname"><a href="../../d8/d23/namespaceMantid_1_1DataHandling.html">Mantid::DataHandling</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/dea/AlignAndFocusPowderSlim_8h_source.html#l00016">AlignAndFocusPowderSlim.h:16</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1DataObjects_html"><div class="ttname"><a href="../../db/d22/namespaceMantid_1_1DataObjects.html">Mantid::DataObjects</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/db9/ConjoinWorkspaces_8h_source.html#l00017">ConjoinWorkspaces.h:17</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1DataObjects_html_a2e1da9579b0472a0eec68fa3d83468e5"><div class="ttname"><a href="../../db/d22/namespaceMantid_1_1DataObjects.html#a2e1da9579b0472a0eec68fa3d83468e5">Mantid::DataObjects::Workspace2D_sptr</a></div><div class="ttdeci">std::shared_ptr&lt; Workspace2D &gt; Workspace2D_sptr</div><div class="ttdoc">shared pointer to Mantid::DataObjects::Workspace2D</div><div class="ttdef"><b>Definition</b> <a href="../../de/de6/Workspace2D__fwd_8h_source.html#l00019">Workspace2D_fwd.h:19</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1DataObjects_html_ada9e481cb775152f9a3a3bef1df129ec"><div class="ttname"><a href="../../db/d22/namespaceMantid_1_1DataObjects.html#ada9e481cb775152f9a3a3bef1df129ec">Mantid::DataObjects::create</a></div><div class="ttdeci">std::unique_ptr&lt; T &gt; create(const P &amp;parent, const IndexArg &amp;indexArg, const HistArg &amp;histArg)</div><div class="ttdoc">This is the create() method that all the other create() methods call.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d8f/WorkspaceCreation_8h_source.html#l00132">WorkspaceCreation.h:132</a></div></div>
<div class="ttc" id="anamespaceMantid_1_1Kernel_html"><div class="ttname"><a href="../../d9/dec/namespaceMantid_1_1Kernel.html">Mantid::Kernel</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d94/AnnularRingAbsorption_8h_source.html#l00015">AnnularRingAbsorption.h:15</a></div></div>
<div class="ttc" id="anamespacestd_html_ad612d1c5d02b14bd78aa4a6372e22512"><div class="ttname"><a href="../../d8/dcc/namespacestd.html#ad612d1c5d02b14bd78aa4a6372e22512">std::to_string</a></div><div class="ttdeci">std::string to_string(const wide_integer&lt; Bits, Signed &gt; &amp;n)</div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html">Mantid::DataHandling::FITSInfo</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00047">LoadFITS.cpp:47</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a11792ce14b3f190f1788bd4cf8649fd4"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a11792ce14b3f190f1788bd4cf8649fd4">Mantid::DataHandling::FITSInfo::isFloat</a></div><div class="ttdeci">bool isFloat</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00059">LoadFITS.cpp:59</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a3a8a69b4a9020254a3a16027fbead8e7"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3a8a69b4a9020254a3a16027fbead8e7">Mantid::DataHandling::FITSInfo::extension</a></div><div class="ttdeci">std::string extension</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00057">LoadFITS.cpp:57</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a3df6e518f071434209df394eb569159c"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3df6e518f071434209df394eb569159c">Mantid::DataHandling::FITSInfo::filePath</a></div><div class="ttdeci">std::string filePath</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00058">LoadFITS.cpp:58</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a3e2d5a8687ddfcb0f8333dd7b7e3fcc7"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a3e2d5a8687ddfcb0f8333dd7b7e3fcc7">Mantid::DataHandling::FITSInfo::imageKey</a></div><div class="ttdeci">std::string imageKey</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00056">LoadFITS.cpp:56</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a40a5ae1d69b263f9ec4624abf71e2be0"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a40a5ae1d69b263f9ec4624abf71e2be0">Mantid::DataHandling::FITSInfo::headerItems</a></div><div class="ttdeci">std::vector&lt; std::string &gt; headerItems</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00048">LoadFITS.cpp:48</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a4efcbfbba068a895f841793977981d29"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a4efcbfbba068a895f841793977981d29">Mantid::DataHandling::FITSInfo::headerSizeMultiplier</a></div><div class="ttdeci">int headerSizeMultiplier</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00053">LoadFITS.cpp:53</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a5efda1565d1df5e0ef5d3cb40f40722a"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a5efda1565d1df5e0ef5d3cb40f40722a">Mantid::DataHandling::FITSInfo::headerKeys</a></div><div class="ttdeci">std::map&lt; std::string, std::string &gt; headerKeys</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00049">LoadFITS.cpp:49</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a7fa96ffe4c950f33c4c97e7b214d51c3"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a7fa96ffe4c950f33c4c97e7b214d51c3">Mantid::DataHandling::FITSInfo::offset</a></div><div class="ttdeci">int offset</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00052">LoadFITS.cpp:52</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_a8aa9b33724c9b55dad77708bcac6f2a7"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#a8aa9b33724c9b55dad77708bcac6f2a7">Mantid::DataHandling::FITSInfo::bitsPerPixel</a></div><div class="ttdeci">int bitsPerPixel</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00050">LoadFITS.cpp:50</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_aba66c40f10a25161ca48b5323b974801"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#aba66c40f10a25161ca48b5323b974801">Mantid::DataHandling::FITSInfo::axisPixelLengths</a></div><div class="ttdeci">std::vector&lt; size_t &gt; axisPixelLengths</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00054">LoadFITS.cpp:54</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_ac6bd18a273b57a12562a139d570e59ab"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#ac6bd18a273b57a12562a139d570e59ab">Mantid::DataHandling::FITSInfo::scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00055">LoadFITS.cpp:55</a></div></div>
<div class="ttc" id="astructMantid_1_1DataHandling_1_1FITSInfo_html_acabafc85e72bf7390a160a4f600166f4"><div class="ttname"><a href="../../d0/d6d/structMantid_1_1DataHandling_1_1FITSInfo.html#acabafc85e72bf7390a160a4f600166f4">Mantid::DataHandling::FITSInfo::numberOfAxis</a></div><div class="ttdeci">int numberOfAxis</div><div class="ttdef"><b>Definition</b> <a href="../../da/de1/LoadFITS_8cpp_source.html#l00051">LoadFITS.cpp:51</a></div></div>
<div class="ttc" id="astructMantid_1_1Kernel_1_1Direction_html_a72f530370990b8f552ac26dc8d6f433fa94629ab0db6cc6a46f605cf640920474"><div class="ttname"><a href="../../d6/de8/structMantid_1_1Kernel_1_1Direction.html#a72f530370990b8f552ac26dc8d6f433fa94629ab0db6cc6a46f605cf640920474">Mantid::Kernel::Direction::Input</a></div><div class="ttdeci">@ Input</div><div class="ttdoc">An input workspace.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d68/Property_8h_source.html#l00053">Property.h:53</a></div></div>
<div class="ttc" id="astructMantid_1_1Kernel_1_1Direction_html_a72f530370990b8f552ac26dc8d6f433fac3cd74bb9eb7553812c23134bb561418"><div class="ttname"><a href="../../d6/de8/structMantid_1_1Kernel_1_1Direction.html#a72f530370990b8f552ac26dc8d6f433fac3cd74bb9eb7553812c23134bb561418">Mantid::Kernel::Direction::Output</a></div><div class="ttdeci">@ Output</div><div class="ttdoc">An output workspace.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d68/Property_8h_source.html#l00054">Property.h:54</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
